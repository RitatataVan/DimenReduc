import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
from sklearn.preprocessing import StandardScaler
from sklearn.decomposition import PCA
from sklearn.manifold import TSNE
from sklearn.metrics.pairwise import euclidean_distances
import os
import copy
import umap
import seaborn as sns
import optuna
import torch
import torch.nn as nn
import torch.optim as optim
import torch.nn.functional as F
from torch.distributions import Normal
from sklearn.metrics import mean_squared_error
from torch.utils.data import DataLoader, TensorDataset
from sklearn.model_selection import train_test_split, GridSearchCV
from tqdm import tqdm


class VAE(nn.Module):
    def __init__(self, input_size=19, latent_size=2, kld_weight=0.00025):
        super(VAE, self).__init__()

        # Encoder
        self.encoder = nn.Sequential(
            nn.Linear(input_size, 32),
            nn.BatchNorm1d(32),
            nn.LeakyReLU(),
            nn.Linear(32, 64),
            nn.BatchNorm1d(64),
            nn.LeakyReLU()
        )
        self.kld_weight = kld_weight
        self.fc_mu = nn.Linear(64, latent_size)
        self.fc_var = nn.Linear(64, latent_size)

        # Decoder
        self.decoder = nn.Sequential(
            nn.Linear(latent_size, 64),
            nn.BatchNorm1d(64),
            nn.LeakyReLU(),
            nn.Linear(64, 32),
            nn.BatchNorm1d(32),
            nn.LeakyReLU(),
            nn.Linear(32, input_size)
        )

    def encode(self, x):
        x = self.encoder(x)
        # Flatten the output for the fully connected layers
        x = torch.flatten(x, start_dim=1)

        # Split the encoder result into mu and var components
        # of the latent Gaussian distribution
        mu = self.fc_mu(x)
        logvar = self.fc_var(x)

        return mu, logvar

    def decode(self, z):
        return self.decoder(z)

    def reparameterize(self, mu, logvar):
        # backpropagate
        std = torch.exp(0.5 * logvar)
        eps = torch.randn_like(std)
        return mu + eps * std

    def forward(self, x):
        # Encode
        mu, logvar = self.encode(x)

        # Reparameterize
        z = self.reparameterize(mu, logvar)

        # Decode
        x_recon = self.decode(z)

        return x_recon, mu, logvar

    def vae_loss(self, x_recon, x, mu, logvar):
        # Reconstruction loss
        recon_loss = F.mse_loss(x_recon, x)

        # KL divergence
        kl_divergence = torch.mean(-0.5 * torch.sum(1 + logvar - mu ** 2 - logvar.exp(), dim=1), dim=0)

        return recon_loss + kl_divergence * self.kld_weight


df = pd.read_csv("/home/fanqiany/data/fanqiany/APOGEEDR17_GAIAEDR3_noflagfilter.csv")
chemical_abundances = ['FE_H', 'C_FE', 'CI_FE', 'N_FE', 'O_FE', 'MG_FE', 'AL_FE',
                       'SI_FE', 'P_FE', 'S_FE', 'K_FE', 'CA_FE', 'TI_FE', 'TIII_FE',
                       'V_FE', 'CR_FE', 'MN_FE', 'CO_FE', 'NI_FE']

# remove 'ASPCAPFLAG' and 'STARFLAG'
selected_df = df[(df['ASPCAPFLAG'] == 0) & (df['STARFLAG'] == 0)][chemical_abundances]

# remove outliers if exist
z_scores = abs((selected_df - selected_df.mean()) / selected_df.std())
data_no_outliers = selected_df[(z_scores < 3).all(axis=1)]

# standard scale
scaler = StandardScaler()
scaled_data = scaler.fit_transform(data_no_outliers)

# save cleaned dataset
cleaned_df = pd.DataFrame(scaled_data, columns=chemical_abundances)
cleaned_df = cleaned_df.to_numpy()  # 133891


# vae_train_loss_history = [0.4467428481060642, 0.2555152126392815, 0.23853573286557395, 0.22892148599648496, 0.224041998499903, 0.22066644411952815, 0.21810291958483813, 0.21593463592483356, 0.21294528225670384, 0.21085899202192734, 0.20992597706648758, 0.20830054490571953, 0.2072956168717912, 0.2066339418282029, 0.20489695239960992, 0.20447233641144943, 0.2032496814257588, 0.20264612461246684, 0.2010677096685949, 0.20128225950448114, 0.19976498454918257, 0.19916999314014563, 0.19873949464899401, 0.1984254476341, 0.19761633364705886, 0.196237205399526, 0.1960655345380934, 0.19558418467969194, 0.1955557512541634, 0.19472031342154328, 0.19466726477574053, 0.19343406162319657, 0.1929202079461326, 0.1931354899711468, 0.19284234593656957, 0.19168334036444484, 0.19129063394255932, 0.19117799325603305, 0.19078215338004267, 0.19034674073099886, 0.1903950497713943, 0.190160729742823, 0.18953875581993268, 0.18904737313401487, 0.18951430494536545, 0.18858060589986292, 0.18837268963490655, 0.18838897609992936, 0.18825772026827395, 0.18775571627861373, 0.18751086932365973, 0.18729376395254052, 0.1873192589345225, 0.18669599679851204, 0.18632975473317745, 0.18675873870142312, 0.18707826504991182, 0.18618689038722525, 0.1862762937395574, 0.18580215678105336, 0.1859423176196471, 0.18539023973296476, 0.18522567706264262, 0.18535942234200745, 0.18471510179128825, 0.18498238520061688, 0.18494458128298555, 0.18453809796797793, 0.18464281395677581, 0.18445760784721488, 0.18411235297284478, 0.18360435787277568, 0.18358292903026888, 0.1836903331889913, 0.18343459120924116, 0.1834950238050023, 0.18363095649892786, 0.1833582976979755, 0.1828977686047456, 0.18257784654690104, 0.18232010997065562, 0.182815659115398, 0.18226599854229544, 0.18272124260243294, 0.18220772273853544, 0.18240407094569744, 0.18206388833244294, 0.18216373048407225, 0.18177379115851716, 0.1818056733497931, 0.18166048495134146, 0.1816416544755852, 0.18197900484542048, 0.18129533104583498, 0.18130601404543747, 0.18092444583921635, 0.1810050873532841, 0.1814634226225286, 0.1803986660591366, 0.18148623118635449, 0.18100224330490436, 0.18086410896858596, 0.18031721192483932, 0.18025765472472013, 0.1803144486314268, 0.1806989171885778, 0.18025768147035126, 0.18016685040058178, 0.1798374847515853, 0.1798678249703893, 0.1800258148708375, 0.1799296983923582, 0.18010474142808164, 0.17959479813891285, 0.18002720213900653, 0.1794175678978615, 0.17947740793846945, 0.17946646001115657, 0.17921066170882338, 0.1796483939352327, 0.17909242605306505, 0.1790539906295867, 0.17950510897120187, 0.17958959163490656, 0.178857332300424, 0.17849457415529038, 0.1787657512072105, 0.17897970308127828, 0.17855013843963283, 0.17887150628183535, 0.17850104174115178, 0.1786214851671537, 0.17857486222503308, 0.17809104221953742, 0.1780661910369439, 0.17780638828431797, 0.17847196555349537, 0.17842689134829948, 0.17789859068884292, 0.17793555970406175, 0.17748701444875226, 0.17826051884297073, 0.177632952485014, 0.17785538505075296, 0.1776761270264317, 0.1781305857667717, 0.17728060253665093, 0.17735037763405972, 0.17706152354017546, 0.17771637766487133, 0.17686413635848056, 0.1775397704590764, 0.177447034467441, 0.17739834212363811, 0.17684055557528056, 0.17701186748555817, 0.17698093862915174, 0.1771227289807833, 0.17720797771931726, 0.1770985882003933, 0.1771450222152887, 0.17684136042273316, 0.17653137499093563, 0.1767404910826115, 0.17685160388983215, 0.17654323369983563, 0.17649384136650115, 0.17670663140073672, 0.17620747782213744, 0.17689745186138958, 0.17612482423840756, 0.1761264422291717, 0.1761092542644861, 0.17622816078523443, 0.17591812795218542, 0.17662996324696706, 0.1758645516145184, 0.17593919564325375, 0.17658180450808167, 0.17613228798731723, 0.17602058371117335, 0.17631220275897747, 0.17579188599789666, 0.1757782223253309, 0.1756742885467746, 0.1756392845127027, 0.175544228884716, 0.1756449833081598, 0.17514178858561746, 0.17544050593049043, 0.175400763081199, 0.1750719527939951, 0.175198866173083, 0.1750779758836381, 0.17515399241849888, 0.1748954807492668, 0.17524027857678778, 0.17441363075429644, 0.17489573039407735, 0.17501582238127308, 0.1750862237848706, 0.17469044047742313, 0.17472326968540505, 0.1745664476457975, 0.17440416212865953, 0.17458852233105168, 0.1746250682864003, 0.1745132876046609, 0.1748155119977527, 0.17472826240688452, 0.17473014140335652, 0.17406285894674775, 0.17447995841703473, 0.17420954044511244, 0.1739509748650395, 0.17435794790060527, 0.17423036163876612, 0.17399426469819596, 0.1738014905727758, 0.17433264469275045, 0.17451950548004824, 0.1742860049385497, 0.17389409135214928, 0.17386780287804726, 0.17380350770743044, 0.17375518284324606, 0.17398775736811412, 0.1736244048103295, 0.17386458528007115, 0.17328980352165577, 0.1739438220483513, 0.17313592964379174, 0.17363434993590365, 0.17368203584421688, 0.1734767518795688, 0.17321483683475716, 0.17357343236627584, 0.17327114413713926, 0.17286916352923665, 0.17320342648954404, 0.17325106194269685, 0.17315323564250168, 0.17326304689800956, 0.17361904088867122, 0.1730457585806077, 0.1733201414288822, 0.1730532902277952, 0.1730121782178777, 0.1725973063882751, 0.17289478025356092, 0.17293341857500735, 0.17292969438318123, 0.17296238942172656, 0.17303730703684986, 0.1730631901624178, 0.17327919324492846, 0.17335059935005423, 0.1729758469921683, 0.17272768204754768, 0.17284897132395843, 0.1723109771202549, 0.17261840185722693, 0.17261259593011125, 0.17218663880182922, 0.1723237011359906, 0.17197501026797896, 0.17273616931781052, 0.1721349473748003, 0.1725384358780478, 0.17214975540735375, 0.17217784800596433, 0.17242963330394365, 0.17251814688700648, 0.17178485544483427, 0.17221191943591058, 0.17209844535945804, 0.17204841298736123, 0.1719361790717071, 0.1718261153957149, 0.1720770423761252, 0.17151603066290866, 0.17187413307828753, 0.17203004283272522, 0.17182416366078657, 0.17192839357724546, 0.1714405832135105, 0.17209869213510784, 0.17184559972071292, 0.17153922456237145, 0.17140082405296217, 0.17140172208804103, 0.17128121924993303, 0.17146294404246096, 0.1716917388564629, 0.1719466357604109, 0.17132630522670128, 0.17149722309925974, 0.17122335938433658, 0.17085019750309824, 0.17074253868910683, 0.17095205887614573, 0.17141624102760566, 0.17093408479257127, 0.1712263122816422, 0.17095813377317193, 0.17120033306478608, 0.17083006456413086, 0.17131904207085982, 0.17105117912444376, 0.17060294300840848, 0.1707467478759455, 0.17110086529189383, 0.17063958660759734, 0.1709603208137846, 0.17108449397183076, 0.17015569825085705, 0.1703328493017356, 0.1710726596441197, 0.17063438464772737, 0.1708828251864807, 0.17053741579366874, 0.17088998927614385, 0.17080413228443003, 0.1706966883002425, 0.1705296372539727, 0.17080628038881712, 0.17034441008535045, 0.17031491905800283, 0.1705269533688693, 0.17044175919781113, 0.17026295116318288, 0.17058305548396457, 0.17026575544063163, 0.1702191548107434, 0.1702386311937976, 0.17031566890504576, 0.17009530570537498, 0.16990177833399145, 0.16991557509198965, 0.17010043968349658, 0.16980981616325166, 0.1697417525547437, 0.17041397741233735, 0.17011543986412522, 0.1699373424598533, 0.1693306451831568, 0.16966107988835663, 0.17013947113116387, 0.16962154095648688, 0.1695342071872463, 0.16981863715987164, 0.16942504073166048, 0.1699620877773146, 0.1692687564838528, 0.17004311459029225, 0.1696108037277425, 0.16991911725348324, 0.16981960756057177, 0.16972067702078322, 0.16969234698186828, 0.1689848362435699, 0.16933925742106368, 0.16910579374238244, 0.16926586527795554, 0.16938607240553014, 0.1694692748982232, 0.16949012857749896, 0.169457892060449, 0.16935080660004728, 0.16920187455222965, 0.17003426484530462, 0.16892184424733322, 0.16950932708711813, 0.16892520388434862, 0.16916628650482335, 0.16881668841886024, 0.16880868585313244, 0.16872535858088233, 0.16878456074739734, 0.16937479824862778, 0.169045362238416, 0.16864416852734765, 0.16902674765309597, 0.16934247448371537, 0.16915506677405331, 0.1688973344292079, 0.16881592539460105, 0.16879057339209316, 0.169377216191019, 0.16919859877528562, 0.16891522046026386, 0.16864735837303788, 0.16810082169499369, 0.16886546363221744, 0.16899486609953496, 0.16856280556736716, 0.1688311307057566, 0.1681983539919063, 0.16821527023771823, 0.16887057227536004, 0.16875231327122164, 0.16841639833205826, 0.16854827589237786, 0.16852857760233078, 0.16884287977888174, 0.1682025977322106, 0.16833781609302656, 0.16869678231165847, 0.16844677991775003, 0.16813152784531588, 0.1684639796328621, 0.1679079298226879, 0.16886172190156098, 0.1687110393106452, 0.16825178924654996, 0.168660733042763, 0.1680975734143592, 0.16833857911728578, 0.16845490969814886, 0.16840768505361653, 0.16819102860265445, 0.1679220735465842, 0.16837949736536426, 0.1683554293256565, 0.1679771682746256, 0.1682092757751324, 0.16820917942230318, 0.16827461113450026, 0.16825171911237452, 0.16773110538870217, 0.16772964569370014, 0.16791111993882268, 0.16750404157233617, 0.1681525581337907, 0.16783491228980849, 0.16788121801715816, 0.16767942252352502, 0.1675021980141176, 0.16741532263949718, 0.16780822533178974, 0.16790815263116268, 0.16753691916874788, 0.16831375320178185, 0.16759585582325873, 0.16800228016577182, 0.16809033024136558, 0.1678631963041794, 0.16771888904525592, 0.16804573895332214, 0.16741403224056176, 0.16759244806937101, 0.1675571040653454, 0.16716587413607384, 0.16727914316435713, 0.16710412431060623, 0.16740527189586363, 0.16758228081755466, 0.16734199715818993, 0.16762228517782893, 0.16705953332083087, 0.16755981127323122, 0.16742536951343637, 0.1674926485689629, 0.1672986572326917, 0.1675051001079124, 0.16768033927047357, 0.1672978928172568, 0.16708173199434137, 0.16735436801562628, 0.16740706674178674, 0.16742631843549657, 0.167249959286346, 0.16734794942919906, 0.16721149976102684, 0.16681816483656442, 0.1673198435203758, 0.1676197409979285, 0.1671693652681297, 0.1669859941627262, 0.16676698929031805, 0.1672602468804254, 0.16664597798973285, 0.1671425389643878, 0.16711966387342683, 0.1670812924184332, 0.16723175677172109, 0.16678189522046222, 0.16675079754766656, 0.16641964331192471, 0.1671470301748168, 0.1665844914270165, 0.16701242632190663, 0.16654469307871803, 0.16673625165935912, 0.16668085773728036, 0.16682384457347088, 0.1664356917913023, 0.16680468557324168, 0.16683892259872718, 0.16664851775793688, 0.1662963604273099, 0.16707237961979798, 0.16705249698672786, 0.16696620127495715, 0.16658417648041843, 0.16699151574020576, 0.16683680368454518, 0.1669533330844492, 0.16644574338299653, 0.1666530134880175, 0.1668912809253389, 0.16644409162895452, 0.16663146827644545, 0.16657253809034517, 0.16669163135139053, 0.16679502854123573, 0.16667686781308785, 0.16603119274581446, 0.1666384012016761, 0.1663970438852117, 0.16664596746687982, 0.16663687042983796, 0.1661415671281012, 0.166043516451298, 0.16682795211767382, 0.16653017556149144, 0.16616251045028751, 0.16638041038306264, 0.16699858588210426, 0.16646861695813245, 0.16615962181528293, 0.1664188243802093, 0.16613106943978, 0.16641755631353922, 0.16557550862452672, 0.1659851734114598, 0.166470174236876, 0.16625460727570598, 0.16596268900826688, 0.16613037206231993, 0.16580600852134364, 0.16633705969209034, 0.16656890477790656, 0.16599348921097012, 0.16642389338486083, 0.16580258318076915, 0.16616515737240892, 0.16598466748203528, 0.1656421556444465, 0.1663804972903653, 0.16617986975996335, 0.1659478416755563, 0.16567598889732177, 0.1663500333003284, 0.16595816770058625, 0.16569904045725128, 0.16584277710264478, 0.16559774429218152, 0.1659882194429705, 0.16603389984574504, 0.16559966979176197, 0.16626861305507126, 0.16606376165925757, 0.16618963087639663, 0.16584908973379162, 0.16636772858561424, 0.16571285937612198, 0.16631163672626628, 0.16590169540253985, 0.16538283012073385, 0.16580201197292888, 0.1655746660851161, 0.16567814167717215, 0.1657982519544331, 0.16641581668727506, 0.1657024676920506, 0.16562540733246195, 0.16551044324561937, 0.16604683487835026, 0.16517818853647503, 0.1656579449989858, 0.16531700929669255, 0.16571444235377605, 0.16545727865812054, 0.16540430280085647, 0.16554533341919409, 0.16564461495149962, 0.1654867404162443, 0.1653324318927988, 0.16564549417231827, 0.16580428155700427, 0.16579354474338676, 0.16524647152560082, 0.16555731400287627, 0.16528259003275458, 0.16489884183083453, 0.1651613393297508, 0.16498901081393266, 0.16537068705106833, 0.1651739814464164, 0.1653126353590365, 0.16518109000034548, 0.1655762415904872, 0.16507180795920456, 0.16550815104213998, 0.16521907578136827, 0.16561821848654892, 0.16531506052552492, 0.16527311767431502, 0.16546281466821336, 0.16562149827898248, 0.16543258957198118, 0.16510515051992455, 0.16513460473787597, 0.1652041618558591, 0.16510376040151473, 0.16534194370052957, 0.16524806338118175, 0.16553757375496997, 0.16495509698861244, 0.16506072339284, 0.1647764062879689, 0.1651402548087953, 0.16482576558811454, 0.16485158719144113, 0.1654127327813909, 0.1648419959498036, 0.16522262427660658, 0.16503656568462405, 0.1649426275591434, 0.16518433870389737, 0.16451325983786227, 0.16480712014540447, 0.16482743837116848, 0.16501719299312917, 0.16494198246763092, 0.165345050797976, 0.1649106213406582, 0.16461340455462592, 0.16482612913014935, 0.16496142502285668, 0.16519800210824442, 0.1645328920236917, 0.16459314618280535, 0.16459897111560706, 0.16481031775162924, 0.1652575637690294, 0.16430487692805737, 0.16466479014447524, 0.1646884246459774, 0.16530366819214184, 0.16481875544595473, 0.16478085424952763, 0.16465573818820384, 0.16429883731458583, 0.16493834011588906, 0.1641277249022429, 0.16457256964576264, 0.16461756933847493, 0.16491397684198647, 0.1649612115675344, 0.16457794975068965, 0.16433950870799577, 0.16471049348940656, 0.1646333579184076, 0.16457265169730562, 0.16464161166814276, 0.16484951812364101, 0.16434545734636688, 0.16449875356133536, 0.1643927547415979, 0.16411534851237902, 0.16404803566129936, 0.1645894042484808, 0.1648997769891588, 0.16462828028067614, 0.16447639654977103, 0.16390582039341273, 0.16443377415819943, 0.1646841953238181, 0.1642366976972673, 0.16465334266043555, 0.1641364451432408, 0.16494087673781013, 0.16441549112566362, 0.16403748535092252, 0.16459702314353075, 0.16418535201190185, 0.16502822772869297, 0.16474840531998072, 0.16442691777434304, 0.16427801936292802, 0.16424144439433186, 0.16422296222779292, 0.16441097305886587, 0.1640833896228042, 0.16449971077814157, 0.16407833199351815, 0.16441854112592036, 0.1645507349349785, 0.16421193540523651, 0.1643521028535843, 0.16415989500011302, 0.16415109998175167, 0.16436335549623263, 0.16395806699414722, 0.16393729820552583, 0.16418655687245148, 0.16432333492375317, 0.16383443950306836, 0.16418076121443834, 0.16362385762304088, 0.1643310806918014, 0.16367403125289273, 0.16411834295575584, 0.16362787765561443, 0.16412552081805845, 0.1640931451901158, 0.16403106301945028, 0.16381030943918304, 0.16412862682816196, 0.16441867293814885, 0.16402766312292297, 0.1641503397899262, 0.16436599041306418, 0.1636598937670283, 0.16390260452049452, 0.1638021148867564, 0.16413209143550536, 0.1638815295430043, 0.16374421311783482, 0.16338784683186083, 0.16379629273408022, 0.16411506669468268, 0.16386021492937805, 0.1637011263429099, 0.16408802743087705, 0.16396980799511449, 0.1640247574476854, 0.16374188807704412, 0.16436438867123224, 0.1634434134211032, 0.16392125809212246, 0.16368230696094518, 0.16357589066384737, 0.16409438984719407, 0.1638273470444857, 0.16373531728486554, 0.1639670354787635, 0.1634406944672427, 0.16369432480810328, 0.16393200218993595, 0.1643499152286778, 0.16383458261220002, 0.16382390515782388, 0.1638907305286947, 0.1637190815476736, 0.16373960260129045, 0.1637990961423224, 0.16371815815313107, 0.1638026160639247, 0.1635428588884407, 0.16391042202090084, 0.16412816975905403, 0.16326798802018122, 0.16347229705334815, 0.16320606808953916, 0.16376776781593394, 0.1634927893630491, 0.16357901082053838, 0.1632379290047304, 0.1636362197327644, 0.16368137805957275, 0.1630510397951565, 0.16375632199351448, 0.16343517440336228, 0.16397220504872428, 0.16342049851024185, 0.16377504996188022, 0.16348963574246123, 0.16354866812098987, 0.16333550651151452, 0.16322598332842894, 0.16332874296582103, 0.16329395037487487, 0.16370364467365284, 0.16331084238529311, 0.16369307353570628, 0.163019630560215, 0.16315927691643603, 0.16319493906008617, 0.16341719273954966, 0.16345197464960526, 0.16371675972661995, 0.1629570955217922, 0.1635859794856293, 0.1631748024250432, 0.16295112217502764, 0.16301158674557115, 0.16363951002690513, 0.16270785876087562, 0.16298883364402525, 0.16290593099087505, 0.16319120430979292, 0.16322374016111074, 0.1630606668801578, 0.16281102388814528, 0.1633213419177568, 0.16339721103807536, 0.1628771287079076, 0.16312038575270077, 0.1633974908613822, 0.16279191610766663, 0.16308766602245614, 0.1633004732349293, 0.1630159465733667, 0.16288925695988246, 0.16294351958900866, 0.1631515839607563, 0.16265916809650005, 0.16308926751165057, 0.1630758449565448, 0.16312630973498668, 0.1627003879258734, 0.16308863252341252, 0.16298792811329169, 0.16238670747353487, 0.1628237311563514, 0.1632824752765539, 0.16294375290698115, 0.16267428821094257, 0.1632068727355495, 0.16321545280836117, 0.16266181423956308, 0.1630237731709492, 0.16284553747045707, 0.1629124398712831, 0.1630096709920112, 0.1629287520674917, 0.1626655927161781, 0.16282475589080977, 0.1632747554901031, 0.16318845964032777, 0.1629691944010397, 0.162495430730591, 0.1630137212731963, 0.16287759206401678, 0.16310616356093013, 0.16319223957378198, 0.163082287623667, 0.1627674515027517, 0.162700511235236, 0.16259503793601576, 0.16295128378290086, 0.16321095762362142, 0.1628162126218296, 0.16300787175553758, 0.1631001981060271, 0.16253502572461573, 0.16273560356556038, 0.16318183088509175, 0.16318241749714235, 0.16272831477202013, 0.16227088169246162, 0.16289268175289018, 0.16221435036293483, 0.16251745796339837, 0.1628232272880928, 0.16267040858027274, 0.16292576754152824, 0.16286202112851467, 0.16270593170540426, 0.16225836552060188, 0.1624710783824259, 0.16279492477776267, 0.16260157199447814, 0.1628749174474824, 0.1631918835607901, 0.1626168673870428, 0.16260835601827794, 0.16206801408203858, 0.16232145217799812, 0.16247851486095294, 0.16238675776954478, 0.16259718137384307, 0.16265999498128872, 0.16243587583759758, 0.16204340164188988, 0.16282545464720324, 0.16256074962400324, 0.1620778679743101, 0.16245834050390254, 0.16214663509480653, 0.16244166163050555, 0.16246978397133977, 0.1626464423156406, 0.1628791854176157, 0.1626014194325858, 0.16227068778927914, 0.16220219871138464, 0.1625364993859089, 0.1626016280154543, 0.16241600250314586, 0.1626683938050521, 0.1625095517371445, 0.16227428882866732, 0.1626665249374522, 0.16281890713774122, 0.16226547544901254, 0.16224231707906428, 0.16196290908489994, 0.1618921072809021, 0.16219503671182386, 0.16248587353936997, 0.16219219682139005, 0.1624639850613143, 0.16241154080233586, 0.1619539238972717, 0.16251618301652973, 0.16209991029413973, 0.16237167845884212, 0.16294933797215513, 0.16277935297973162, 0.16246247579705253, 0.16243673485631913, 0.16213457382293356, 0.16216174426125274, 0.16167955541483398, 0.16233577646314543, 0.1620176943676085, 0.16215748750622147, 0.16271543072767383, 0.16224136784092896, 0.16241207242288033, 0.16223347472622784, 0.16273933106838467, 0.16183410806624365, 0.16273487054951757, 0.16299461964616604, 0.16221702330115484, 0.162706815886599, 0.1628135431437418, 0.16258467651057237, 0.16265127675805208, 0.1624487524942444, 0.161996589473163, 0.1625723586124127, 0.16224940242706967, 0.1622236248027024, 0.1622789281024829, 0.16233659266147882, 0.16181165508136283, 0.16194804626450848, 0.16220213103903375, 0.16235955415224154, 0.1622712901460999, 0.1620302987344431, 0.16197855951440762, 0.16216049335946495, 0.1619460204444657, 0.16198392492629332, 0.16195603037434292, 0.16223277363711097, 0.16193773256863409, 0.16177385784026194, 0.1616574770301654, 0.16202883643738603, 0.16185632952387333, 0.1619083513417765, 0.1615104800142641, 0.1617691991222618, 0.16180466581685501, 0.16198731007858408, 0.16194151258110706, 0.16207475090714207, 0.16213985090629152, 0.1621296665508046, 0.16172663915107457, 0.16222956884685485, 0.1619431414063476, 0.1617884476407522, 0.16194457286604758, 0.1614494801259876, 0.16206677971298286, 0.16191230133477458, 0.16218135189783922, 0.1619550165344597, 0.16176332533470822, 0.16169519193592344, 0.16168091581995667, 0.16220252554641382, 0.16148438378283722, 0.16182061551051533, 0.1614260062997145, 0.16160115937187136, 0.16186231284926297, 0.161639278231649, 0.1614693335788691, 0.1619745367740497, 0.16185317587212314, 0.1615889306703331, 0.16197234282318904, 0.16152992261066867, 0.16174841854537395, 0.161583344839456, 0.16148039421923746, 0.16179463804320177, 0.16179032870562424, 0.1612307854846484, 0.16195257740724486, 0.1613251214429755, 0.16176971665743048, 0.16172498905086224, 0.16210967030876183, 0.16176633778101157, 0.16209241752975667, 0.16142728314525973, 0.16158413581966918, 0.16165433035655252, 0.16165932778131883, 0.16186113352847337, 0.16182766273919352, 0.16158757781206035, 0.16152823659586438, 0.1617187514285705, 0.16193403820250207, 0.16147556781782155, 0.16153939762235855, 0.16106908239267861, 0.1615874878541876, 0.16108239555908235, 0.16167921682937836, 0.16143194135019426, 0.16135804785963792, 0.1615730982338646, 0.16137445062249778, 0.16132217867120313, 0.16197385735277262, 0.16141179717275309, 0.16146141206971543, 0.16132619883955546, 0.16152887976087674, 0.16156906800564252, 0.16124780465742944, 0.16152659232968647, 0.16137834508198765, 0.1616916131920736, 0.16162957973926825, 0.16105446425560868, 0.16167276882236734, 0.16184432136597576, 0.16151345112039026, 0.16136009213334818, 0.16127880703023767, 0.1610956345324164, 0.16184271195932218, 0.16166754182578646, 0.16129503333748424, 0.16129181571836226, 0.1615712091407958, 0.16106200378686714, 0.16134546081906198, 0.16131360573901812, 0.16161146340964755, 0.16165255110626553, 0.1613548921077689, 0.16122352865476108, 0.1614996880099241, 0.16078638571145973, 0.161674518867981, 0.16111650499706173, 0.16126294839737423, 0.16183051919797348, 0.1612414962543438, 0.1612607154802386, 0.16152705467301973, 0.1612488177872566, 0.1615201678046084, 0.16100221159046105, 0.16058818411436224, 0.16140041221260126, 0.16108060265524052, 0.16123055703690378, 0.16122391989677354, 0.16099423069034718, 0.1611200958953355, 0.1610754988567282, 0.16070956224349572, 0.16186236931318948, 0.16168595031566016, 0.16118097378084165, 0.16157504751698487, 0.16142518238091239, 0.16120918265948223, 0.16133602125786783, 0.1611430712355306, 0.16113704355945954, 0.16093739189652173, 0.16097630146718095, 0.16169217105019182, 0.1612912338841655, 0.160939825304335, 0.1607437626632532, 0.16100642149514638, 0.16081432985270278, 0.16092604646690575, 0.16104678466411923, 0.16093459761884393, 0.16135745817030667, 0.16155148258428434, 0.16120121078865515, 0.1611776797628018, 0.16108709082716352, 0.1608710333452311, 0.16080611798069513, 0.16104193670615755, 0.16106925419842621, 0.160963700719629, 0.1608959044527995, 0.16151827107231562, 0.16091971051854118, 0.16102228838380292, 0.16106781498598227, 0.1613420251537379, 0.16143582092187822, 0.1609084347946185, 0.16108856548565142, 0.1611853325491178, 0.1613137486439252, 0.16105620047182292, 0.1609804771689769, 0.16081838729120865, 0.1612202806178606, 0.16091641373818286, 0.16145428880382504, 0.16143943388419865, 0.1610165136123453, 0.1606829355278367, 0.16151202620589375, 0.16092783934292404, 0.1610712918067354, 0.16075190078959328, 0.1607837048791523, 0.16118595404183858, 0.16111242623016292, 0.16087379757573958, 0.1611294626646521, 0.16112194024374188, 0.16022057249664645, 0.16008664751076895, 0.16082099082534224, 0.16073502859174293, 0.16088033748938224, 0.16077142241368134, 0.16128408368400057, 0.1607268042202998, 0.16107731331600283, 0.16099945338541277, 0.16106660110560583, 0.1614109748198584, 0.16062993312471432, 0.1603901483598768, 0.16076809425618974, 0.16049954919295453, 0.16082002988908867, 0.1606871557461422, 0.16062074149328934, 0.16066432923726268, 0.1603701673005692, 0.1607027314105288, 0.1607719129522508, 0.16075847807355417, 0.16035398325612754, 0.16054465537849752, 0.16061377858766582, 0.16099626335052267, 0.16041121584950288, 0.1612085219511878, 0.1606509497251332, 0.16095983731340674, 0.16058404977444582, 0.16072251244881963, 0.16117781183545837, 0.16087826094707333, 0.16108146460099576, 0.16017127552339822, 0.16079503628126546, 0.16060795261760352, 0.16070859147441227, 0.1611027312390932, 0.16085897924180828, 0.1605751526332149, 0.16109055056205313, 0.16123823917591418, 0.16073563942583194, 0.16117322361000053, 0.16099295084654008, 0.16117500041738297, 0.16110622822632933, 0.16048612977522822, 0.16080618365976948, 0.16101566732455086, 0.16097936958277126, 0.16094173796725902, 0.16106264167654122, 0.16049296661362245, 0.16073785900548784, 0.16090455565586842, 0.1601466728704488, 0.1607468327376189, 0.16076646744759748, 0.16076552212256118, 0.1607290019017372, 0.1605302769009354, 0.16089818182857177, 0.16054293668775832, 0.16072419191730752, 0.16066464232302413, 0.16049085076447875, 0.16052231030099484, 0.16043242847993364, 0.16054279926742235, 0.16081021580892696, 0.1609557782411041, 0.1608068468554861, 0.16026231099750082, 0.16043943496385782, 0.1611626067669239, 0.16031059424883756, 0.16128346147899783, 0.16092908564047673, 0.16096433094670734, 0.16066927352690769, 0.15998125766094506, 0.16026522932464668, 0.1603077971242578, 0.16026857913550985, 0.15964208918584186, 0.16052523534028523, 0.16024361146810528, 0.1603673914665424, 0.1602807756853082, 0.15999243562194282, 0.16005080415924933, 0.16010749058817292, 0.16002381350312278, 0.16016340457513428, 0.16047836023922132, 0.1599140547049554, 0.16039229482712833, 0.16041518151159112, 0.16042958924613476, 0.16053398114330195, 0.16042883081832007, 0.1603985375400102, 0.15985852222845423, 0.16015472192259098, 0.16086913701248398, 0.16036575587684912, 0.16009596147328176, 0.16032536125840186, 0.16086268125384193, 0.16013771987796516, 0.16018650187692093, 0.1602308382570579, 0.15991752223821953, 0.16046610289838353, 0.16031706153865677, 0.16044553125271457, 0.16035734302113114, 0.1602713384624022, 0.16018967162067874, 0.16024854020440593, 0.16062526930388168, 0.15982740507585988, 0.16034133519969818, 0.15968071325497146, 0.16036802063298836, 0.16028109744644137, 0.16035233160113727, 0.16052419289782954, 0.15982267836498193, 0.1597596321785563, 0.16027490983302087, 0.16060438859907025, 0.16028695040642524, 0.16018883674942858, 0.15988667571938184, 0.15989936479434858, 0.16035012321988928, 0.16020514586946946, 0.16020389289761225, 0.1607144520636037, 0.16017968624783502, 0.16022085565766206, 0.16041750020639473, 0.16086200979454165, 0.16007409573482767, 0.160147158583308, 0.16013861996419346, 0.16033208042225155, 0.16032799995477956, 0.16043827139896777, 0.16027876224784215, 0.16050776531973399, 0.16058413295284113, 0.16012433012900837, 0.16020996366340307, 0.15994127526010105, 0.16008554362731656, 0.16030173162267583, 0.1602487122093699, 0.16022543753045518, 0.16001927151032885, 0.16004246208209935, 0.1605432429567588, 0.1600454089439283, 0.16042061189917278, 0.15993896813208872, 0.15966304517106591, 0.16009485341518934, 0.15999724675270127, 0.1600812121015995, 0.160107216214936, 0.16026922292710774, 0.1602045447357704, 0.1598242722828417, 0.16020025779111344, 0.16026406832397166, 0.15994762105687665, 0.15990630289809166, 0.16003673980470928, 0.1597023877468322, 0.15983643422686625, 0.15997659982328089, 0.15975213615437034, 0.15983590910923348, 0.15989582602509783, 0.1602942040878037, 0.16007024153930147, 0.16017440349293197, 0.1606062980812101, 0.1601610391958129, 0.16041002572317334, 0.1602577734253068, 0.16040827687619666, 0.16009904190689822, 0.15963846369181073, 0.15954210024848176, 0.15998520675134834, 0.16029105227017956, 0.1595311254002496, 0.15994055331559096, 0.15978368127156395, 0.16000596414568427, 0.15964076900572993, 0.16000756681348274, 0.15993791573883145, 0.15977756883950434, 0.15970797866273473, 0.15972973836800258, 0.1598218099519291, 0.16009006900835968, 0.1603888503773644, 0.15986793394944018, 0.1596353062694179, 0.160060667354591, 0.15955189073319057, 0.159677186932848, 0.15968587716229066, 0.15987226553191722, 0.15960693993417238, 0.16000701473375192, 0.15995508272458747, 0.1599070078134982, 0.15991698946132984, 0.15973047893646006, 0.15979375531015638, 0.16022706393950176, 0.1596355082514359, 0.1593533447266195, 0.15949772644237956, 0.16022705653176936, 0.15994449696260193, 0.1602231859648875, 0.15972878305098592, 0.1599635555299618, 0.15953640211077247, 0.160125641776205, 0.1596283357913468, 0.1598956877555882, 0.15965155734070494, 0.16001320238946418, 0.1598894827680526, 0.15986548529768002, 0.15971040328388228, 0.15920094146170444, 0.15959850380575427, 0.159209201495102, 0.15995836298890784, 0.15956920533381813, 0.15913366427035336, 0.15965316836446117, 0.16006085146612242, 0.16028653740531185, 0.15923209912422231, 0.15971161693443647, 0.15949225767615555, 0.1594698181022085, 0.15978913920108567, 0.1598294322859654, 0.15980502056353424, 0.1597722915647206, 0.15978864733032636, 0.15944362093931494, 0.1597433357749743, 0.159555903990182, 0.1597269937052151, 0.1593723081275448, 0.15962513186695845, 0.15963506780186942, 0.16004525360413632, 0.1594207513774427, 0.159617589995186, 0.15948802675136184, 0.15981061778201916, 0.15958246701002674, 0.15925248449814222, 0.15940099252562195, 0.15947941160200246, 0.15886270776986453, 0.16014885428625988, 0.15907538272938473, 0.15947130881152521, 0.15932581061382559, 0.15974363921599283, 0.1596304430964458, 0.15915259409887011, 0.15934890868576712, 0.15954497017384253, 0.15944616911745435, 0.15915772013671725, 0.15948051019787424, 0.1593531215119214, 0.1591216111285112, 0.15937768650852688, 0.15930763073752463, 0.15956474157295517, 0.15946708100519094, 0.15877525030061923, 0.15971514990860572, 0.15982796945135805, 0.1602054714390852, 0.15902689936688308, 0.1593032980838423, 0.1588990195413729, 0.1591922769701252, 0.15907397315677388, 0.15919384693305233, 0.15940029055616908, 0.15917378542483615, 0.1589507384368878, 0.1586169644158543, 0.15912494743384065, 0.15967611145052582, 0.15992845657652813, 0.15944954134683575, 0.15955819368398041, 0.15916354912062258, 0.15962558857714304, 0.15961050686081937, 0.15978517652835578, 0.15948221772359372, 0.15963932242561948, 0.1595973137517659, 0.1595966083600208, 0.15977955762088517, 0.15931807863399797, 0.15888595946989545, 0.15901254523378283, 0.15935640410562638, 0.15972605850571203, 0.15928457563955706, 0.15920212770275846, 0.15933474130298036, 0.15916753258642102, 0.1593612493324319, 0.1591751475360967, 0.15928578618945885, 0.1590151454335465, 0.1596351776635712, 0.15949421367030742, 0.15971697328809895, 0.15906246337811206, 0.1595045149802663, 0.15871222314547723, 0.15951770393471265, 0.15972104309137447, 0.15958773813024915, 0.1593512244446335, 0.15964298809791788, 0.15958256547855595, 0.15928235952893688, 0.1596339488191524, 0.1598983290829574, 0.1597591528829124, 0.15964443537806794, 0.15899946675204263, 0.15925942762236017, 0.1594855365412881, 0.15943753183782836, 0.15936694527931766, 0.15958837576505985, 0.15932339192687714, 0.15918180953152852, 0.15928004083413327, 0.1589528417053514, 0.15947746285309367, 0.15950056217486744, 0.15915258418312617, 0.15932939042275956, 0.15923469383051134, 0.15914569655123761, 0.1593355276477961, 0.15907422204923663, 0.15921338143553207, 0.15935677728127468, 0.1589316249525888, 0.15862390376386493, 0.1592888458578303, 0.15920669331215112, 0.15911155084920292, 0.15884183235597252, 0.1591406286283643, 0.15874261768357126, 0.15931963124506876, 0.1593387916364737, 0.15884146102001495, 0.15913896576717548, 0.15912717348858474, 0.15903773792552683, 0.15881864322879885, 0.1594525290391151, 0.15940855512925123, 0.15906512817517185, 0.15948454907698328, 0.1599211164040868, 0.15964819191305976, 0.15952054225033557, 0.15913197447934174, 0.15920235977980224, 0.15909776555671837, 0.1595832127670131, 0.15883307908289873, 0.1587391642445864, 0.1589647312571732, 0.15882081577669951, 0.1592470960216763, 0.1590913347190414, 0.1590513564338516, 0.15863914795559902, 0.15868441051819457, 0.15895264866469785, 0.1590113933319534, 0.15912784131302116, 0.15875432387843535, 0.1594005182827282, 0.1589133424197633, 0.158945361567279, 0.15926247578960384, 0.15936787628470422, 0.15907994998926828, 0.1591762365428726, 0.15947394710501844, 0.15943641541598758, 0.15890075234308548, 0.1593053510902407, 0.15899305566794772, 0.1594024343534762, 0.15913412180800926, 0.15936033529660656, 0.1588828397049595, 0.1592233442540788, 0.1593617766514611, 0.15911596597011152, 0.15899120346440684, 0.15958505222070687, 0.1591225085915386, 0.15888910110077462, 0.15890606344903643, 0.1591063960257046, 0.1591382567951006, 0.15873333721055294, 0.15879678304391817, 0.1591163213153391, 0.15923596216094832, 0.1589588952639682, 0.15921394829344415, 0.15822588836953552, 0.1589708701905735, 0.1590985095652751, 0.15913581415878417, 0.15885014989723484, 0.15869901781633639, 0.1592767075326304, 0.15908791604275505, 0.1588008842009552, 0.15904320427666982, 0.159367718740177, 0.15893114956559215, 0.15934358596182963, 0.1590399998742735, 0.1591188284543517, 0.15898975520932085, 0.15882211880083266, 0.1591177925448571, 0.15905766257099027, 0.15847080627890214, 0.15930507951604927, 0.1589122950414162, 0.15919446188613434, 0.1590574147536281, 0.15888962763406778, 0.15882522588047207, 0.15873288637613803, 0.1594360449625919, 0.15897272737007162, 0.15910403992051692, 0.1592600792446079, 0.1588932045905351, 0.15901634035108514, 0.15873768657893308, 0.1588263922176971, 0.15872747399148293, 0.1591045900759735, 0.15873227301678688, 0.15874514383272165, 0.15874266395296222, 0.15905602991612125, 0.15853574449099492, 0.15853023188047746, 0.15921570057606838, 0.15858591128516583, 0.15851515685682185, 0.15849610958246985, 0.15849833532113886, 0.1586309518806697, 0.15832593367399633, 0.15834514560679164, 0.15834737354129236, 0.1588921749502347, 0.1587044996184332, 0.15874913673069133, 0.15901390737843163, 0.1587243394377928, 0.158475906603927, 0.15872547997037792, 0.1591073493127177, 0.15857815722459745, 0.1588585764899782, 0.15853292855104203, 0.1589476308631028, 0.15872439520279263, 0.1589033155731895, 0.15853413085628013, 0.15871680111073602, 0.1588365120348737, 0.15890790607683672, 0.1588582402016319, 0.15879967882177526, 0.1583774752413526, 0.1584899438628161, 0.1590268775487963, 0.15817426053370448, 0.15869830889323086, 0.1588791101743575, 0.15910057354693682, 0.15914985863286693, 0.15912887492651936, 0.15903006134565456, 0.15873680373883176, 0.15859997655009125, 0.15897205086247293, 0.1588948558370762, 0.15856347954298153, 0.15884956511263262, 0.1592040609428405, 0.15806653015318314, 0.15849898230353732, 0.1584495493779217, 0.15866041076851975, 0.15888944675451575, 0.15839166218295678, 0.15856035055510717, 0.15880040980447566, 0.15873350211940787, 0.1584193748537087, 0.15860816094359645, 0.15846884223151236, 0.15868365478592195, 0.15812114290116802, 0.15863110685541718, 0.15853419235181093, 0.15847706740872447, 0.1588512780183068, 0.15875093200509655, 0.15817680984537386, 0.15881205099359444, 0.1585538293488824, 0.15870479550703706, 0.15843464138661162, 0.15909337902057516, 0.15872927222631003, 0.15815104476495964, 0.15868325114575163, 0.15822917727583935, 0.15859226160827072, 0.15824757632797706, 0.15866316478779854, 0.15884691218730984, 0.15853944927313765, 0.15847934116855286, 0.15860464011939934, 0.15846954955754816, 0.15849476290546902, 0.15828583442663557, 0.1580323573727481, 0.1582114400082096, 0.1583825985363577, 0.1587693638133009, 0.1587042596361726, 0.15862986245320226, 0.15860587367600845, 0.15824545351405134, 0.1579775218958637, 0.15850593396178353, 0.15813195478485237, 0.15857566377141494, 0.1587813785186278, 0.15896335866535136, 0.15874963543935747, 0.15798345752618553, 0.15807382775787385, 0.15839653802787013, 0.1583985902591054, 0.15845491470856274, 0.1583532811366414, 0.1583619262519254, 0.15850955585322607, 0.1581693207637111, 0.15860800311749523, 0.15850311200638686, 0.15838321202258407, 0.15819716668906245, 0.15852726729840888, 0.15800445063465499, 0.15843219848207651, 0.15850350712811015, 0.15818312500512166, 0.15814254582996676, 0.15840541098879793, 0.15904372690465454, 0.1582214164085265, 0.15883904383887507, 0.15842922721568692, 0.15861126636050263, 0.15834672373536365, 0.1588296021063339, 0.15870290114419475, 0.15873814646823242, 0.1587040600358474, 0.15853583565306936, 0.15819323338794694, 0.15847519695741014, 0.15841995278148407, 0.1587163092422026, 0.15796770254147668, 0.15882249957007444, 0.15862430945518474, 0.15823499343087882, 0.1581717326695127, 0.15846905167357098, 0.15811589832235215, 0.15839461670626856, 0.157834269379615, 0.15803617270828513, 0.15780275812697683, 0.15797045527753503, 0.15831388974285027, 0.1586735513946351, 0.15788472956161234, 0.1582263806776805, 0.15817649972226017, 0.15884000260378162, 0.15838800838796008, 0.15827936787247007, 0.15818497603117143, 0.15790598751877338, 0.15792318272313738, 0.15843001743242288, 0.15819375997688712, 0.15831996233720244, 0.15800881862920843, 0.15812901452498684, 0.15819008128541, 0.15777051573137482, 0.15794723952659723, 0.1582581866737067, 0.15805744228454566, 0.1582412129779029, 0.15816783243274837, 0.15834161413286627, 0.15819688156927145, 0.15796873653782645, 0.1581224721862467, 0.15869354394060226, 0.1581179848232532, 0.15807232523691894, 0.15826916424975615, 0.15844336161759304, 0.15854156991126458, 0.15794613167439878, 0.15787760242046292, 0.15784661233340558, 0.1582238783821852, 0.15853215014817013, 0.15826493917791684, 0.15838995021103977, 0.1581025438647406, 0.15771236801037947, 0.15832058912974617, 0.1584484212913509, 0.15821461155159228, 0.15790631183187923, 0.15843171179316845, 0.15836215782258123, 0.15832867117389837, 0.15839010034004403, 0.1580640631267743, 0.15802554903509228, 0.1579591971224921, 0.1578661195092992, 0.15801494477046987, 0.15771211866049817, 0.1576876976450133, 0.1583197833251647, 0.15814353232712625, 0.15794615954910812, 0.1581339334201106, 0.15840522683274888, 0.15789105228045244, 0.15845383492917706, 0.1587386917779458, 0.15801149056578193, 0.1581682257092162, 0.15849111947528777, 0.15794897083140477, 0.1582469693390977, 0.15855352065812323, 0.1581133257468862, 0.1581230106380203, 0.1582364654572623, 0.1581488297283271, 0.15882125207388478, 0.15824995548105086, 0.1588406151963167, 0.15839637678726728, 0.15839079020849414, 0.15818820807066425, 0.1576008853941557, 0.15784591708277487, 0.1582979589302266, 0.15806271166412902, 0.1582298810638371, 0.1579889389298496, 0.15804632464381344, 0.15759883431592686, 0.15822268905605993, 0.15867263423033384, 0.15870014675430671, 0.1587781497623096, 0.1580406911991132, 0.15793518922386643, 0.15843632867016816, 0.15792837217912012, 0.15819440725644074, 0.1583631707498532, 0.15814544828324137, 0.15873023087992252, 0.15811079529955938, 0.15828118961482776, 0.15813686906850688, 0.15833929871567262, 0.1579198627724695, 0.15801557127587496, 0.15788458604681385, 0.15739817867932393, 0.1579519477370642, 0.1581926549203954, 0.15768925047978516, 0.1580561527102992, 0.15813379256690943, 0.1583144355867751, 0.1582619850641672, 0.158659546210693, 0.1578890641957724, 0.15772833178496376, 0.15844652770088932, 0.15800446088595052, 0.15809949041325513, 0.1577912914001948, 0.15797215896806133, 0.15824641029458483, 0.15765869452413073, 0.15793327539235485, 0.15774201894614007, 0.15809087254164314, 0.15807661682420746, 0.15773989280007028, 0.157770685878841, 0.15812427207156465, 0.1577872203771364, 0.15817407440107303, 0.15766511814216225, 0.15826378237080188, 0.15801204561483817, 0.15812101485179159, 0.1579754589714955, 0.15784769898965098, 0.15728352972827933, 0.15783354940946148, 0.15802567070064164, 0.15841880830686347, 0.1577156440566551, 0.1579567005808995, 0.15787255927498536, 0.15808851222174955, 0.15808052492222746, 0.15793172817793283, 0.15787990652684164, 0.15818747845910663, 0.157621034250399, 0.15808346330790107, 0.15849731603007275, 0.1574669802920743, 0.15775143949163176, 0.1576008812751627, 0.15842627450646826, 0.1581403539469497, 0.15800658906870155, 0.15765544074445695, 0.15767614308162323, 0.15796757020171437, 0.15832656102968798, 0.1575740818823236, 0.15812878735267213, 0.1579147399359959, 0.1580426115858447, 0.15811279588478783, 0.1580559915097622, 0.15782727991922965, 0.1574556360421753, 0.15803276302567143, 0.15773713136805084, 0.15810581368967846, 0.15770681629780828, 0.15792608270123218, 0.1579788009539348, 0.15825881220862761, 0.158137225414268, 0.15819422371584785, 0.15768125488551704, 0.15801763041179348, 0.15789291398850572, 0.15789934844769127, 0.15770862201382185, 0.157987201896737, 0.15795783911686925, 0.15781420882630182, 0.15788912275759187, 0.15806461734446395, 0.15765622015787886, 0.15829612885639588, 0.15769771509948166, 0.1578949891741401, 0.15796072638852163, 0.15796650277596894, 0.15795277253397638, 0.15799780723868584, 0.1578296691956108, 0.15797361264873258, 0.1576946445398739, 0.15849887913394717, 0.1583013059698678, 0.15789804133127566, 0.1581550380680397, 0.15805705415320206, 0.1583347292989103, 0.15806577873132932, 0.15795571970186398]
# vae_test_loss_history = [0.2514895108158431, 0.22303075872025285, 0.21146665054722857, 0.2053345437689382, 0.19995241118764373, 0.19644832748805235, 0.19442578649840497, 0.19374094339730097, 0.19083684123447386, 0.18894868207209772, 0.1902964817843946, 0.18638893265454237, 0.1866083513449962, 0.18561711426280542, 0.18395182096549503, 0.18279483996451606, 0.18441891192292575, 0.18209909642556013, 0.1834222066304055, 0.1811370740311564, 0.1820771118441744, 0.17956268595631536, 0.17908532274856012, 0.17833703879474672, 0.17738133370642603, 0.1767314632216536, 0.17636079594051648, 0.17962485736909212, 0.17725004955061724, 0.17554271020839068, 0.17626000523406943, 0.1757894012979781, 0.17564071721778057, 0.1749696694123896, 0.17393403307592242, 0.17353465436382234, 0.1745251132129906, 0.17451960548528694, 0.17274958051808176, 0.17254431243304102, 0.17267825087355937, 0.17286940810315715, 0.17162225649933235, 0.1719265072695362, 0.17306451075837123, 0.17219563182331396, 0.17409578630359673, 0.1714452437302758, 0.17181451731129863, 0.1732245373833397, 0.17073398803188017, 0.1708237459011068, 0.1707909361833979, 0.1714641511308955, 0.1722661901342312, 0.172215716200322, 0.17164176324280664, 0.17142759833097182, 0.16915561647361563, 0.16944833541162171, 0.1699040220094193, 0.1696333249666331, 0.16961658272715982, 0.1695230990028385, 0.168611986880551, 0.16994837827852813, 0.16961605182648096, 0.16917095871174048, 0.1691986910558948, 0.1694370720395987, 0.17085748867834738, 0.16874752148366534, 0.16788291801944769, 0.16784788937644163, 0.16838252922343577, 0.16805521909074744, 0.16861887607037512, 0.16761239938550063, 0.16737838367913424, 0.1669972665017258, 0.16776778740624948, 0.16721553800253308, 0.16682497252126205, 0.16755284065114778, 0.16746360884093292, 0.16831953546009426, 0.1666465846909237, 0.16581292415093465, 0.16578952532198035, 0.16696781984349648, 0.1668590776667646, 0.16730586068859207, 0.16640511872391886, 0.16725942598210453, 0.1687508814058826, 0.1674057023821002, 0.16549657427831477, 0.16664179539405818, 0.16520344519696192, 0.16529394082641302, 0.16598977138461132, 0.16515395484096534, 0.16579244097547227, 0.1674461379798053, 0.16602432267073533, 0.16469306475701115, 0.1654649017202502, 0.16805192367159993, 0.16460729220637846, 0.16558208370623628, 0.166382930429153, 0.1665308204887428, 0.16428606644110877, 0.1655023260669955, 0.16468242179613374, 0.1642323973491232, 0.16499432863761437, 0.16934207198426554, 0.1651907933955143, 0.16448010396739715, 0.16374745743982225, 0.16567835063014894, 0.16423112379369006, 0.16409810314762427, 0.16536045543382885, 0.16502149761949528, 0.165456711603242, 0.16415513691613162, 0.16381274882154942, 0.16442314795769955, 0.16382789190584135, 0.16349678138220408, 0.16404366183727884, 0.16416069801958438, 0.16389491915237628, 0.16416595302851322, 0.16405916211040075, 0.1630587598085715, 0.16370614230245492, 0.16361464936191752, 0.16304316859156892, 0.16286608528864296, 0.16502971982249465, 0.16326820969842024, 0.16420132935674825, 0.16252575944766218, 0.1659190412409752, 0.16376997886643682, 0.1631365019226142, 0.16368295781117112, 0.16278021786726546, 0.16213088824862598, 0.16338085476076047, 0.16244303195786097, 0.16257881944779787, 0.1618133401872063, 0.16489390940516893, 0.16252426221288432, 0.1628986439051757, 0.16099658700751557, 0.16248051993961476, 0.1621876457132464, 0.16221978580630286, 0.1633196676392646, 0.16188979997728462, 0.1624496943416506, 0.16176284467752414, 0.16173100602707374, 0.16191137239986345, 0.1628692274860816, 0.161654171637417, 0.16135700221407417, 0.1616856719131515, 0.162250166156747, 0.16157620209745513, 0.16213546818025376, 0.16282112889152925, 0.16218608390862485, 0.16176586687774075, 0.16033309236919513, 0.16137523744818014, 0.1607367749783576, 0.15973999147073903, 0.1611729175110564, 0.16082455003549584, 0.16228380716382543, 0.16041393703977042, 0.16081462867833166, 0.15997718588208293, 0.1620474806072607, 0.16146081423208797, 0.160784794350638, 0.16026638072022864, 0.16062916952056203, 0.1607544618337059, 0.1597785807222572, 0.16209024526052246, 0.16130131376406634, 0.16114131621191494, 0.16083576403486752, 0.16110624808380872, 0.16111552781519003, 0.15863600106394946, 0.16023966153595534, 0.159785697514395, 0.15975510164938966, 0.1621611562380046, 0.16166663732319997, 0.15942561461335758, 0.15964733992721936, 0.15940246577768846, 0.16053410352039846, 0.1602797187663624, 0.1598376292441672, 0.16021093026200314, 0.15940987070605542, 0.15913534739241045, 0.15875668237944635, 0.16211230100456553, 0.1589394100751864, 0.15896919908563267, 0.1592608861904254, 0.16012919021243052, 0.16010921854538185, 0.15899702486990014, 0.1595605347854891, 0.1581162480796228, 0.15877482266713036, 0.1592207280072805, 0.15775582295880342, 0.15786784120136915, 0.1585659042277326, 0.15854540279126692, 0.1583918896019114, 0.15925188432265897, 0.15883898574621996, 0.1596367799746963, 0.15759793893429272, 0.15812607652863955, 0.1594009626334169, 0.15850929880904324, 0.15873915444496273, 0.1577526836337571, 0.15789058297530884, 0.15903925350871212, 0.15853446583474715, 0.15895304827073756, 0.15819108333485793, 0.15702194710240175, 0.1570789459086305, 0.15680278007179935, 0.1586524384130556, 0.15815647170345484, 0.15847267639506116, 0.16004707192966422, 0.15756008222517207, 0.16053131145044564, 0.15857057460688812, 0.15781462161040358, 0.16026605629347593, 0.1570142800512634, 0.1565059644184608, 0.1598470888929222, 0.15679870016402406, 0.15803215882434415, 0.15650234680114083, 0.15876277688815715, 0.15815752967977867, 0.15723075159207064, 0.15628804139971816, 0.15906121539586138, 0.15625866367111435, 0.15868002589337254, 0.15723885160098533, 0.1565867511826752, 0.157629959687294, 0.15654063153900813, 0.15686913877820197, 0.1560605760939051, 0.1559728915672056, 0.15632273802488744, 0.15717937425961392, 0.1561921073383327, 0.15636080827317356, 0.15789503694068077, 0.1589829868631565, 0.1572076937776287, 0.15606399743423607, 0.15640159583743005, 0.15651971153288088, 0.15733152538746092, 0.15622550295451976, 0.1558945043328772, 0.15655109751444427, 0.15746238810956253, 0.15619800124866762, 0.15618947434004232, 0.1567813920065048, 0.1555049434115601, 0.15589559705835945, 0.15526662453930598, 0.15675385230238556, 0.155360960321918, 0.15535998468620915, 0.15633727083654364, 0.15502846000332904, 0.15633690251816718, 0.15675361680294053, 0.15647728345589026, 0.15618981441359855, 0.15851610594371102, 0.1566894952244112, 0.1551670875898188, 0.15496495989097359, 0.15562972118364046, 0.15531038194911484, 0.1565974037773628, 0.15720207732636987, 0.1561746108549313, 0.1554975911494691, 0.15634164461809888, 0.15639799837304166, 0.15560720972081066, 0.15581387458535723, 0.15495270132459818, 0.1570528144708042, 0.15449849128558435, 0.15502477198791334, 0.15590266538652794, 0.157018376826136, 0.15467935265860042, 0.15621876636318108, 0.1557501195328805, 0.1549403367106333, 0.1560988742972939, 0.1545571732597402, 0.1551345940990228, 0.1548740242145795, 0.15456650797667898, 0.15634593553096862, 0.15517509586747674, 0.15458911517720195, 0.15541581303040386, 0.1543798453877988, 0.1563750683589131, 0.1566419699553606, 0.15583952861010011, 0.15528234039098074, 0.15546925604919895, 0.15474658879405234, 0.15536967548464342, 0.1568474133119781, 0.15607030247951081, 0.15381744574365777, 0.15530527469756075, 0.15433218988563754, 0.15649025510172895, 0.15769458582140056, 0.1541281125602393, 0.1545540533920636, 0.1540311694516911, 0.15408656456489275, 0.15661250101411098, 0.15440204835279933, 0.15477437791831375, 0.15630522437668828, 0.1539680012219552, 0.15463357613171191, 0.15628507627730917, 0.15359330837033658, 0.1541613802292103, 0.1535810183606692, 0.15365429564243765, 0.1539097957560959, 0.15635325574045544, 0.15485955330403517, 0.15565471172804632, 0.1571747529387158, 0.1540016397166641, 0.1537118304119228, 0.15417570538726744, 0.15457178481734757, 0.15437649830732314, 0.15453409281560992, 0.15418087341534895, 0.15431215174958304, 0.15375133717688655, 0.15549018489786523, 0.15456552993321312, 0.15448335182044, 0.15455177251223537, 0.15222817665721575, 0.15405480901794957, 0.15439553977999856, 0.15300180451923118, 0.15389253023039873, 0.1531653277437692, 0.15279329066536257, 0.15496807696249146, 0.15365445138152406, 0.15713113460566946, 0.15455968526977196, 0.15371980104298974, 0.1537996012150046, 0.15372053885718984, 0.15501900913534716, 0.15669878253352185, 0.15447434201269564, 0.15498407032666148, 0.1547071539824607, 0.15510887589228153, 0.15445188005216992, 0.1530583577802394, 0.1532826684274837, 0.1536027307136041, 0.15318001917636379, 0.15362393085477313, 0.15441027931487028, 0.15259232072202703, 0.15326588774736594, 0.15306808864248134, 0.15259281463049948, 0.15251289483297084, 0.1546729810942394, 0.15409719014506998, 0.15307878235377903, 0.15402179927111267, 0.15463305936985844, 0.15464972028089846, 0.152747434157205, 0.1534136124869218, 0.15285629224848893, 0.1528377891173351, 0.15359824815563103, 0.1528311790075245, 0.1539942409365077, 0.15483200157003418, 0.1523624910005173, 0.15228947426955042, 0.1535441387034214, 0.15339634067000657, 0.1531863234659801, 0.15191182082780397, 0.15234456342010672, 0.15224785617659084, 0.15321222590925607, 0.15381576906504474, 0.15290141202974875, 0.15253088174926108, 0.15288741192389355, 0.1540696325983975, 0.15342249595002466, 0.15367933254019986, 0.15151897568087755, 0.1521109612775822, 0.15103986292800356, 0.15250332419924992, 0.15130858703568, 0.15358402950701647, 0.15259973260489984, 0.15300019076058904, 0.1551796535550357, 0.1518482619209942, 0.1516002476078476, 0.15397395286114365, 0.1538367745496057, 0.15147461811524135, 0.15191239342880844, 0.15279515009534658, 0.15208902067518282, 0.15196700555802176, 0.15258260777857194, 0.15290946298541408, 0.1518951640406112, 0.15393061236500263, 0.15247943249014184, 0.1526941682852215, 0.1520353216161658, 0.15279776969934097, 0.15281745809464206, 0.15285239383450874, 0.15358141523380828, 0.15200507272969857, 0.1529979608938253, 0.1511549129528463, 0.15458281355798678, 0.15165640645578002, 0.15163935138151, 0.15441717732386254, 0.15153066167017581, 0.1515729558526181, 0.1517317779714156, 0.15198837471404938, 0.15228782416696557, 0.15109072719510086, 0.15180537428015078, 0.15145486226490593, 0.1516555354848836, 0.1509956644390379, 0.15105955618333458, 0.15304890445553299, 0.15156688380666075, 0.15467802582590978, 0.15173067676286067, 0.15193112685549157, 0.152823880810067, 0.15086762768301046, 0.1534435888205282, 0.1512697623520472, 0.15300582723178804, 0.15168551971339553, 0.15109262270638343, 0.15108167861618105, 0.15251368209494295, 0.15767901491647413, 0.15145932121383962, 0.15236363552477072, 0.1519360143907343, 0.15246841705254086, 0.15186399854047727, 0.15309689434934462, 0.15311523669608443, 0.15331783012424288, 0.15335049985372493, 0.15147817466445435, 0.15405000457619797, 0.15186441131805598, 0.1533277597012791, 0.1520683447411616, 0.15312908660175154, 0.15115906808424745, 0.1508189631709686, 0.15293554656580105, 0.15206203875270496, 0.15378186822275883, 0.15078961607045824, 0.1506347658982167, 0.15234144036842606, 0.15147574886959544, 0.15168881985012192, 0.15044995698118108, 0.15074592468282624, 0.1504158715445634, 0.15236616605789347, 0.15062043861841762, 0.15133843567692418, 0.15091104693178004, 0.1519916867665854, 0.1530341486957067, 0.15099151057745452, 0.15287668459803794, 0.15218478721410728, 0.15289764174939519, 0.15125875202320907, 0.1517946614275467, 0.15207509085446413, 0.15229812426870054, 0.15008153008425973, 0.15098084559008007, 0.15161444481757574, 0.15132769946401356, 0.1517570308333502, 0.15308875636664662, 0.1513255021367473, 0.15068575260813158, 0.1517686995749397, 0.15338221146118972, 0.15090039710542869, 0.1502945349229727, 0.1520845330112291, 0.15083981057824233, 0.15016129869445888, 0.15034837509925258, 0.15143354676006987, 0.15058596890667758, 0.15148883950047454, 0.15193194409451122, 0.14936190030386853, 0.15212796075364385, 0.1498972607857973, 0.15321989321636117, 0.15020157088297761, 0.1515902048790311, 0.15279432093439638, 0.14972874931700356, 0.1514552933986408, 0.15015653961001904, 0.15292698591741669, 0.15030995537452654, 0.1500481685661852, 0.15125531556970967, 0.15134993208053865, 0.15121409217305873, 0.15136515905515738, 0.15054674764649328, 0.15009973728555273, 0.15475960787609813, 0.15079820849043976, 0.15131668881299118, 0.15093894138748043, 0.15029375625925828, 0.15192405031078973, 0.15061216210594694, 0.15020667603449128, 0.15132772048778861, 0.15086725994055922, 0.15143964004403532, 0.1512061470663304, 0.15091808620104266, 0.15017550239906563, 0.14964669899786642, 0.15155853669632896, 0.14955802230556914, 0.14991716497777943, 0.14939747002334547, 0.1523009273969743, 0.14921985466065635, 0.14967429439757268, 0.15033339029924708, 0.15195759923104019, 0.15080481940765858, 0.15088077502499694, 0.15051530296451557, 0.15065867778251435, 0.14935327444182842, 0.15025927659430602, 0.1513252546936702, 0.15047610405468193, 0.1496331786466342, 0.15378443108170245, 0.1503172603539905, 0.15052242099642285, 0.15043583382319609, 0.15078897591425852, 0.15159644226505453, 0.15106859028455127, 0.15047749840918084, 0.15065150841146316, 0.15289641448277028, 0.15094551014808505, 0.14967485174407053, 0.1512159297273435, 0.15017592162422472, 0.15022487812980365, 0.1501786331074914, 0.15174459662535908, 0.14939696818936277, 0.15139991225176516, 0.14953739256075166, 0.14991290377096633, 0.15110251765222849, 0.15096322505460913, 0.15042513972460955, 0.15248071732480636, 0.1499920323028687, 0.14994057491290935, 0.1492406069762748, 0.14972576866019383, 0.15376328146614812, 0.15143355199848546, 0.15023998579997996, 0.1530151564109414, 0.1500843597034249, 0.15119468074326306, 0.15023195766152642, 0.14908813416942274, 0.1493776213255156, 0.15277170019211836, 0.1499453594215269, 0.14859466896631296, 0.1504694504310768, 0.14890964709965454, 0.15010797275263885, 0.14937740246224135, 0.1508350360183854, 0.15183597742629784, 0.1495024617449066, 0.15000768410720589, 0.15054861507766468, 0.14961583700866132, 0.14935249595283914, 0.15174383578527864, 0.14824258462287362, 0.14969243389120326, 0.15255739824290843, 0.14933859485938242, 0.14967795966366346, 0.1509010888717632, 0.14905268589004142, 0.1489990327069471, 0.14974064310179552, 0.14920021115413654, 0.1502870526369961, 0.14962729283097015, 0.15004928089760922, 0.14860749514623595, 0.14875185479026357, 0.1495296913859041, 0.14850666360029063, 0.14963910966269123, 0.15103360643183492, 0.14932607863685576, 0.14942713512639905, 0.15147882898285034, 0.15287917251825786, 0.14948123318864381, 0.1497051331427692, 0.1520547868340396, 0.15088164634478715, 0.15032722608577662, 0.148280188232608, 0.14977063838195095, 0.1501794555715719, 0.1484481949455027, 0.14958444937499937, 0.15103419205542706, 0.14985158226413364, 0.1499907350593803, 0.14872436406649878, 0.14890824321929663, 0.1492063067757463, 0.14889552441799034, 0.14930354867541873, 0.1494628542642525, 0.14908154363161044, 0.14944209492457197, 0.1489924387419623, 0.1487994846367641, 0.15115323674554604, 0.14749917799401102, 0.1478539543694683, 0.15011930626623438, 0.14895468801532655, 0.1485830043858528, 0.14939007092044834, 0.14947793495886988, 0.1487528585611721, 0.14984155646084163, 0.15149463991282558, 0.15094572177918517, 0.1499609756008541, 0.14841930517692617, 0.14957121333774465, 0.1560707222894983, 0.15057798441834871, 0.14973677249637915, 0.1491007152005099, 0.14884457103884413, 0.14880114909240738, 0.15128740367257634, 0.1490805801220491, 0.15117329187612474, 0.14874642273412755, 0.15085426680631014, 0.1501932700397525, 0.15046721780321062, 0.14984004660745845, 0.1507162536079566, 0.1506045259950702, 0.14900729653236913, 0.1504739140096703, 0.14891807760229087, 0.15098340232807916, 0.15010707686671604, 0.15011142930898938, 0.14958435770216985, 0.1493053753550109, 0.14955426428880617, 0.14831584754824492, 0.14939490200611497, 0.1508663386449264, 0.14837541568937657, 0.15019342235333577, 0.14894295086717405, 0.14926858379373523, 0.14906104427237077, 0.15065825275803854, 0.14810082472927866, 0.1480547035592706, 0.1520737219169091, 0.1486985802248695, 0.1490947664270364, 0.14941685973603, 0.1488974195414276, 0.14881910862581765, 0.14772292506085372, 0.1502614392497603, 0.14909258148522314, 0.1487654065797797, 0.14834030723815725, 0.1498649915152149, 0.14793079827218572, 0.14832264077890897, 0.14802767294690494, 0.15015453389836433, 0.14892220522728025, 0.1478977493034493, 0.1503304524651216, 0.1497570007517525, 0.15016809580524532, 0.14674003410463554, 0.14849684040582653, 0.15174058125570983, 0.14805159365704812, 0.1490607549264204, 0.14811124690713098, 0.1476467331589201, 0.149608181389778, 0.1489013498778028, 0.1496508588012176, 0.1475681589837124, 0.14781275257140475, 0.14822888267545953, 0.1492301006738304, 0.15214523645402017, 0.14981760102435443, 0.1476197245769466, 0.1481015860762846, 0.14715723316320636, 0.147007769900127, 0.14840684303405718, 0.14829495389723538, 0.1483864558277709, 0.148051068594081, 0.14618786605940073, 0.14737311129791875, 0.14766893122883434, 0.14688377872339226, 0.1486056664895787, 0.1470803642809144, 0.14787145730712745, 0.14679760808934286, 0.15168200533860313, 0.14790770498186226, 0.1483867138283644, 0.1501782956959896, 0.14847358494998136, 0.1494418970934195, 0.15056687970510266, 0.1490579273911586, 0.1483898884907363, 0.14797108181950813, 0.1479475086627154, 0.14939822496227895, 0.14838278720128162, 0.14839358605983352, 0.14942322703131042, 0.14925070234020607, 0.14868758303936863, 0.1481487303599423, 0.14841524154641167, 0.14825941215214422, 0.14988671829187736, 0.14978748908233525, 0.1497704061060179, 0.15019092748139223, 0.14896924214901475, 0.1500413846922195, 0.1478627067085849, 0.1483861846176227, 0.1484202856186894, 0.14876210515988078, 0.14775310103852504, 0.14871047632393494, 0.14685978026779412, 0.1474740911766076, 0.14824253002070986, 0.1480491141397721, 0.14858210821558432, 0.14740473689275832, 0.14857584567581764, 0.14717909356620848, 0.14743159998934033, 0.1470916882041028, 0.1486463015488333, 0.14837415396962433, 0.14891286912867735, 0.15018579107355362, 0.14730764056361412, 0.14941030404085967, 0.1476898931834637, 0.1505204015337881, 0.14750736176081752, 0.14894654292676843, 0.14669709126567096, 0.14773844600329233, 0.14762370949434048, 0.14877175172057971, 0.1474170826035772, 0.14742421614818368, 0.14702067624661674, 0.14713590865167867, 0.14719056482387002, 0.1486440253960436, 0.14736304110553713, 0.14756025482999802, 0.14674317977042395, 0.14831118108649388, 0.14660168183878647, 0.14918302726792793, 0.1489436932898889, 0.14807400475642007, 0.14840275413850954, 0.1488645875061986, 0.15086043079553144, 0.1480760609241333, 0.14758754328937712, 0.14735233134567935, 0.14804489843995564, 0.14764942165024986, 0.1479499731653145, 0.15027890117375248, 0.14642497824809697, 0.14815323829757718, 0.14709678851394933, 0.14753827148003504, 0.14700547161956645, 0.14705049902965261, 0.14764319665802617, 0.1469842131074012, 0.14808405986679443, 0.14751407134988773, 0.1482281532363809, 0.14698023921772357, 0.14730106200671605, 0.14866366835724287, 0.1466295180915384, 0.148256634014574, 0.14969757184374569, 0.14793724622259558, 0.14904077168689145, 0.14834625912886087, 0.1481919856514228, 0.15059444063498809, 0.14928302810098534, 0.14859428877664282, 0.14658664751644473, 0.14751410694874456, 0.1481699950898743, 0.14742454081699194, 0.14791386460685013, 0.14871591864990294, 0.14781410437254094, 0.14990422109654505, 0.14767992720795273, 0.14860597163813843, 0.1481058560994836, 0.1481889471283165, 0.14836760003172153, 0.14679341743977006, 0.1488396081464277, 0.1492153166163212, 0.14639064742837823, 0.14748778313185798, 0.14682675889060623, 0.1482622083314766, 0.14618882454199728, 0.14852381093110573, 0.1465780834948635, 0.14641212776635493, 0.15024324732078032, 0.1490915261592683, 0.14580427777155533, 0.15025836542215895, 0.147011072179184, 0.14878239537423674, 0.1471471543235995, 0.14771258679447324, 0.14587368105968637, 0.1472523634444163, 0.14785315245395503, 0.14729327017066415, 0.1467200720469133, 0.14704770073080406, 0.14713500753679992, 0.14830964192602836, 0.14733012095764247, 0.1463929992649775, 0.14933033765237075, 0.1482316383908971, 0.14697880178179137, 0.1505683621655898, 0.14804508257744234, 0.14795671160239618, 0.14529133340149564, 0.14675419748724208, 0.1452016101356377, 0.14842017984264724, 0.14713166223584975, 0.14669272564110894, 0.14812319148407696, 0.14639151582847792, 0.14724166133128758, 0.14651623839130812, 0.14913988951416268, 0.1471875502509067, 0.14594947485928397, 0.14803108887520802, 0.14657723609795023, 0.1473189069209887, 0.14830638897900195, 0.14671798187568397, 0.14688937552975792, 0.1468121805396793, 0.14782193617168313, 0.14761313476307514, 0.14744205107251845, 0.14738622894664694, 0.1464666607161429, 0.14828561240886262, 0.14874542585707187, 0.14720788453717606, 0.1471260723739739, 0.14753699317029736, 0.15000086378913655, 0.14586755788659242, 0.1489427330350007, 0.14545735012688565, 0.14670395622712734, 0.14759162722974198, 0.14661826594532762, 0.1467120384591498, 0.14573832910778212, 0.14572635156287256, 0.1494852900416034, 0.1474424671370444, 0.1455530647713296, 0.1479670345825524, 0.14616973776320347, 0.14698669774289974, 0.14652507535081327, 0.14751651638064944, 0.14696762153108195, 0.14683879715695472, 0.14594434921818678, 0.1470861683101872, 0.14610820053647972, 0.14936656972203574, 0.14656706489106486, 0.14642269113269565, 0.14772626281022766, 0.14667249697897103, 0.1461715469435717, 0.1459615925387666, 0.14671823807950202, 0.14638431598124402, 0.14642410197312394, 0.14562003848575317, 0.14625320394750785, 0.14834941588635717, 0.14582691192148406, 0.14610129416627726, 0.14531391838799804, 0.14668363953133962, 0.14586609428417888, 0.14710559110490748, 0.1473382593398712, 0.14602355176288084, 0.14686049212306854, 0.14704473360851555, 0.14672572255677677, 0.14630609428062616, 0.1473213587949664, 0.14503427263061472, 0.14643900247937672, 0.14689491693879345, 0.14644083394165236, 0.14664479290745944, 0.1473720839891963, 0.14709444865770785, 0.14627399771416258, 0.14716850005811116, 0.145949752555964, 0.1459629132738836, 0.14809238503242725, 0.1478311961630184, 0.14720821703244655, 0.1469545563349531, 0.1450191498578425, 0.14840843757237707, 0.14688348690012873, 0.14659767184221362, 0.14822449955334296, 0.14792618331317473, 0.14539951721899155, 0.14632768701750692, 0.14736683790349164, 0.14706279852121948, 0.1463767060613324, 0.14811052880237224, 0.14661540213846155, 0.1475152865181876, 0.14562101386605172, 0.146169086326103, 0.1449082859113399, 0.14750611776008676, 0.14716545680073254, 0.14643853937594867, 0.1463077124124049, 0.14690708265044058, 0.14660310980172236, 0.14790285701741293, 0.14533596675630298, 0.1466214342786429, 0.14550232283854228, 0.14619374949624314, 0.14768687860437948, 0.14657001835363104, 0.14547984639029732, 0.14734554944822228, 0.14556026699348998, 0.14610297486412502, 0.14572513814349344, 0.1449239785334738, 0.14637765500471517, 0.14650137046127848, 0.14689738352696532, 0.14638476900792807, 0.14648992834543378, 0.14536687239563276, 0.14646718780180396, 0.14495946474490473, 0.14543616041413673, 0.14691577255425378, 0.1455878958068759, 0.1455079432467135, 0.1468913810321876, 0.1463451719935326, 0.14702627397334986, 0.14645415847218415, 0.14524365818822368, 0.1453787275917647, 0.1450217682098255, 0.14409082077287516, 0.14496387079941817, 0.1446855150399943, 0.14747922588838813, 0.14591386097162787, 0.1456691441370484, 0.14595557040243437, 0.14624977173081496, 0.1466105282184252, 0.14561352439575562, 0.14543462575200897, 0.145428516270355, 0.1463697570643159, 0.14667283935789754, 0.1468688100826803, 0.14565314392799303, 0.14687342844827514, 0.14853864181606624, 0.148196619781232, 0.14520486219290138, 0.14540759849670312, 0.14428232518355866, 0.14565113647186914, 0.1484619487506716, 0.14525986632687707, 0.14506091138623356, 0.1456763111242699, 0.14393680822295496, 0.1450424592803861, 0.14568797138723838, 0.14516307283758365, 0.14715574725384523, 0.14707085258688107, 0.1451471296423442, 0.14477889777318273, 0.14520686364437868, 0.1489314821296723, 0.14637660536567423, 0.14640696514139806, 0.14661420986471996, 0.14573138194649254, 0.14551241822361863, 0.1453018595591711, 0.14586171577892382, 0.14583729814824703, 0.14562144710761732, 0.14599907161287679, 0.14477927695846152, 0.14640093677227498, 0.14673587706238683, 0.14474399125081003, 0.14522223698524842, 0.14416946686417284, 0.14431962849029553, 0.14538919729485603, 0.14833359802747273, 0.14785119336720404, 0.14551340965247722, 0.14590055676151895, 0.14679464286677293, 0.14544149217470173, 0.1468693029461406, 0.14892083932738304, 0.1459263286795483, 0.14664964629562205, 0.14994338295741444, 0.14565548319328517, 0.14519817520347122, 0.1477763471170832, 0.1454067362754187, 0.14551095100595265, 0.14728080460229204, 0.14547050293209332, 0.14371285527313551, 0.14667947062781334, 0.1445808567029099, 0.14698617489682742, 0.14657894113378628, 0.14499211715044444, 0.1466220161078059, 0.14560586864721953, 0.14549036355797468, 0.14526633097800581, 0.14386496451869787, 0.14530124243998074, 0.1468827530851312, 0.14499370864053399, 0.14654485968579864, 0.14621755014962418, 0.14679494328885062, 0.14535179349278277, 0.14726252949023255, 0.1447817594688794, 0.1475311590894128, 0.14593668677055513, 0.14660368029044454, 0.14609217305360853, 0.14419852429933083, 0.14472004362075286, 0.14459594338603682, 0.14546470321530416, 0.14543000591071006, 0.14643486543481019, 0.14482241022835668, 0.14537912493232136, 0.14474755556694516, 0.14819740204517468, 0.14513759633915094, 0.1474734564758388, 0.1457194861835226, 0.1452906287617019, 0.14477628314774202, 0.1452574367420406, 0.1461781694544159, 0.14494490364446877, 0.14760048506556306, 0.1439691266068832, 0.14458161955177307, 0.14484413822531286, 0.14529409850534916, 0.14634093650136384, 0.14636495274887834, 0.14423322540224923, 0.1462790819298202, 0.14484227268551333, 0.14479931517575764, 0.1458403856973366, 0.14429353330292843, 0.14595615124056083, 0.1443777112006126, 0.14737958217849964, 0.14487667693820339, 0.14591252587454925, 0.14422210459036264, 0.14748987994653792, 0.14701406107088988, 0.146094121473779, 0.1451357877118935, 0.14588489888965642, 0.14615212773850716, 0.1453358709980212, 0.14510918171723902, 0.14569904893406332, 0.14715422935865383, 0.14504007917559572, 0.14483765355480044, 0.1443565399636565, 0.14393416866412498, 0.14564398868660702, 0.14610671148929982, 0.14684819729287912, 0.14502090776806661, 0.1463379135326905, 0.14603397888089184, 0.14541394041844277, 0.14483530280439058, 0.1445738947144669, 0.1444527632546944, 0.1453418789498992, 0.14751583581063535, 0.14567270322200176, 0.1457042766925472, 0.14631382630447762, 0.14424807353770075, 0.14534130155842095, 0.14625631406674566, 0.14511136259697094, 0.1454656243707117, 0.1450930503113025, 0.14576470233126348, 0.1459508053689929, 0.14755775960303968, 0.1442921747815516, 0.1482001124439213, 0.14593949344508156, 0.1472591971334107, 0.1485561697800417, 0.14603281979324206, 0.14557293568373644, 0.1446414594739701, 0.14460022952401339, 0.1460910709525086, 0.1462466451223091, 0.1474307819401302, 0.1467947372344874, 0.15007835776509668, 0.14602513989646695, 0.14448964291917604, 0.1455580801569662, 0.1455896944798082, 0.14596182374464725, 0.14558122587596165, 0.1457272511374991, 0.14578741303695816, 0.1448134157469009, 0.14403902324926302, 0.14633252762847612, 0.1448288233761889, 0.1452766101461105, 0.14557400557197472, 0.14443237396339184, 0.1449629672072262, 0.14498109029283035, 0.1456036349448494, 0.1454893351057485, 0.14594953895280688, 0.14531384722867938, 0.1455475741872786, 0.14394838607853452, 0.1442030966510035, 0.14417770265733837, 0.14490461961025305, 0.14408162193979168, 0.14435653755979463, 0.14648561758734904, 0.1444869008640173, 0.14569022505446017, 0.14516573733759316, 0.14529466033683, 0.14390831060882572, 0.14459497230876225, 0.14463899649548617, 0.14544330482008103, 0.14534659825098195, 0.14590500254096228, 0.14738929609240264, 0.14545660608323338, 0.1457188410443176, 0.14605743750813535, 0.1464517783979985, 0.1463699050242383, 0.14572739932667866, 0.14775578760008792, 0.14507575047659846, 0.14523184899711072, 0.1460529781335178, 0.1452823504930766, 0.14751609985260108, 0.14501453720141955, 0.1448427925534679, 0.14590770687997384, 0.14454553097541029, 0.14521858788012051, 0.14484343559597118, 0.1451522229698624, 0.14542780781053544, 0.1437980948575488, 0.1452501776012172, 0.14548066928061812, 0.14400327691827888, 0.14468386045409581, 0.14617981393129628, 0.14562468872366255, 0.14687258047821888, 0.14559409357536418, 0.14478251038635234, 0.14582346177821404, 0.14469996640413701, 0.14409379062343558, 0.1444375302136632, 0.14573569865969985, 0.1457407127749622, 0.1431502970047174, 0.14454333297428368, 0.1456430455369765, 0.14400738806846788, 0.14498349913601166, 0.1459621093156442, 0.14501056282317926, 0.1448241124402115, 0.1458498832386333, 0.14561685934118054, 0.14600353349040418, 0.1431859546359817, 0.14462795219262375, 0.14534748658143343, 0.14523244634620674, 0.14548872176262445, 0.1463273874512486, 0.14421730219356296, 0.14573258302048298, 0.14500598667985967, 0.14545633959511564, 0.14573913896995072, 0.1457585892872198, 0.14496798899870947, 0.14356720684532126, 0.14758114565925212, 0.1442452456351823, 0.14485879900588666, 0.14480238853204624, 0.14590878603754792, 0.14442661408894342, 0.14478412816033406, 0.14336802373311622, 0.1455876296442811, 0.1441798980654103, 0.1436530099116446, 0.14494950102245777, 0.14482533632306702, 0.14384063566842611, 0.14760651278864825, 0.144059325474025, 0.14413731078098352, 0.1432996090031208, 0.14414501244439373, 0.14788546349219342, 0.14459767803555887, 0.14604467388482173, 0.14711355379098845, 0.1440988633166934, 0.14382006639186304, 0.14327948230924106, 0.1444530660344486, 0.145039607087734, 0.14504953318584793, 0.14388792290117847, 0.14405886272449883, 0.14426906193759267, 0.14349174511864898, 0.14457403585287484, 0.1455084434202509, 0.14677875489914646, 0.14354929195307223, 0.14384023213124783, 0.14348456441884241, 0.1441120952395605, 0.1462021338847964, 0.14419252697897703, 0.14352100943505414, 0.14497353096920254, 0.14380688769394717, 0.14437153658042357, 0.14553683997424752, 0.14564241306645728, 0.14596703996570717, 0.14344075116543092, 0.14596621301664373, 0.14465175250156256, 0.14476356749983507, 0.14583410230796356, 0.14408889864438715, 0.14735411022514647, 0.14629444768405744, 0.14448809683926098, 0.14467093399418243, 0.14631461193549625, 0.1445910728002459, 0.14581146717144985, 0.14411809732646075, 0.14417380670063917, 0.14556512802671231, 0.1440427828780602, 0.14507807285976915, 0.14436862624046795, 0.1434586910255691, 0.14455937207470757, 0.14751538423795385, 0.1468520331508064, 0.14579395893193986, 0.14413109506421656, 0.14406214726005054, 0.1447903495951761, 0.1434576162183172, 0.14410067167741153, 0.14567147304737174, 0.1446434096208034, 0.14469214282820556, 0.14670108519086933, 0.14545758986814522, 0.14754700389436434, 0.14563077731397644, 0.14520348163389848, 0.14650693586330363, 0.14449654938675718, 0.14540913299467828, 0.14567936407054724, 0.1460068671214954, 0.14629271291322937, 0.1471303196990413, 0.14379782378818232, 0.14363592072535078, 0.14433654301655052, 0.14525842886757398, 0.14498665134175104, 0.1433010596463819, 0.1449379412998981, 0.14491903495987116, 0.1456516741868286, 0.14488081183598775, 0.14523587083938058, 0.14444324603845624, 0.1444247501222266, 0.143084247535109, 0.14485127415319257, 0.14332622903087522, 0.14475092299455328, 0.14295063941358715, 0.14265445789399533, 0.1445405743424943, 0.14594208878954706, 0.1450268926534434, 0.1440460824438694, 0.14325774740897237, 0.1460389899429158, 0.14470463910257403, 0.14456969640202802, 0.14379651731987406, 0.14376715808542587, 0.1450551428105843, 0.14450012365944323, 0.14355831013371223, 0.14403384550612966, 0.14485332884464527, 0.14947849347725037, 0.1464019882342445, 0.14474098815183545, 0.14416844877915733, 0.14252793857854004, 0.14394173487047668, 0.14322785236540428, 0.14335182182892303, 0.14447027591519565, 0.14358099316661677, 0.14425244709222462, 0.14442661976083318, 0.14499447434843465, 0.14450669788883355, 0.14431296892436615, 0.14405810386037055, 0.14299622211186444, 0.14559677761008988, 0.14674661101611244, 0.14403271074366983, 0.14315859009437518, 0.14358414317382415, 0.14595171090708875, 0.1436682804445738, 0.14470877614880995, 0.1436686669288007, 0.14460349914894427, 0.14593097421490295, 0.14465214950157212, 0.14515286791041493, 0.14627720098360333, 0.1455329656250389, 0.14487271528429382, 0.14284886630556173, 0.1447906214380074, 0.1442936600665764, 0.1456605450864146, 0.14487511755413718, 0.14450237380823486, 0.1444176815353091, 0.14339802768553714, 0.1437729654038717, 0.1429141450252805, 0.14257799576515978, 0.14390955033991948, 0.14473553688038526, 0.14372123673476436, 0.14407215069685486, 0.14215743070015288, 0.14456946052085864, 0.1441660843667993, 0.1442333645162939, 0.14372927829533633, 0.14371211154165142, 0.14411969443335151, 0.14507183317839153, 0.14390626125817535, 0.14250425571661524, 0.14289681009419347, 0.14417774653560733, 0.14523628374049108, 0.14463943557476347, 0.14535394135836574, 0.14351694553688743, 0.14424320668067794, 0.14417575234635246, 0.1441258586635155, 0.14316856232771724, 0.1453843015130317, 0.1463541864643238, 0.14402124843427272, 0.14335922201522733, 0.14532185372569892, 0.1465708627807733, 0.14404537671899914, 0.14352682655758373, 0.14311876929546605, 0.1434523498528105, 0.1445728647570448, 0.14271754597274508, 0.14323975291996088, 0.1449146498122784, 0.14373495747514745, 0.1427939824715166, 0.14424033210094953, 0.1442119518013993, 0.1437131230377484, 0.14331395156524898, 0.1442387889880232, 0.14402917574964114, 0.14392127852311407, 0.14414054688317063, 0.1436976371688783, 0.14554500816770183, 0.1430124455979515, 0.14372280621115519, 0.14527930877205505, 0.143708239460531, 0.14339807237900462, 0.14369106940431828, 0.1434031956073368, 0.14447071981777723, 0.1430903849655521, 0.14581047639697584, 0.1429671638815401, 0.14299644406899795, 0.14369863999660495, 0.143911017226498, 0.14335450924964396, 0.14444301310758212, 0.14393479151752744, 0.14440100230984668, 0.14371600423644365, 0.14452951187044277, 0.14297462940781416, 0.14388703237720304, 0.14396262821265673, 0.14361602015084685, 0.14365253122929983, 0.14205269423811495, 0.14302941923861925, 0.1442194619026171, 0.14223729083739178, 0.14376765643547823, 0.14369209889821793, 0.1424383352303319, 0.14515749734601616, 0.14359985350663276, 0.14416678964038904, 0.14551205762486608, 0.1445083607457974, 0.14493256694646248, 0.14291504980549213, 0.14341193108547703, 0.14621459860291366, 0.14446283159855078, 0.1447539673197585, 0.14398408309084293, 0.1447797299306135, 0.14358576290205652, 0.1434854246319006, 0.14513060934609315, 0.14296013898870677, 0.14267000440974015, 0.14299063108255752, 0.14413922169979632, 0.14529416422815622, 0.14482268889214595, 0.14621230690570713, 0.14515349571621797, 0.14549991648825472, 0.14468538185825777, 0.14466221596518564, 0.14456213900148968, 0.14506894496453743, 0.14231058177053582, 0.14352979831175788, 0.1431988206432213, 0.1454964663844926, 0.14498811823166824, 0.14301096781776113, 0.1449588613065818, 0.14555300116358713, 0.14279230161619363, 0.14400865035023414, 0.14329679900492148, 0.14227311216942196, 0.14306366846892987, 0.14393492884036116, 0.14521887973510167, 0.14280912811547622, 0.1435107521126004, 0.1422019517884911, 0.14287058097610883, 0.14413369022616662, 0.14365901408578688, 0.14214227077881195, 0.14307751341051098, 0.14336261026461933, 0.14490353384484114, 0.14639128511338573, 0.14317798702532264, 0.1439751659664404, 0.14415054160041127, 0.14378459652502332, 0.144435246694595, 0.14421067104217092, 0.14421458300402712, 0.14246278667477552, 0.14410504266503385, 0.1426664037173882, 0.143020835272775, 0.14375141514245068, 0.14258555520731134, 0.143612863393907, 0.14342931493515262, 0.14273607393156276, 0.14320315385404342, 0.14353491179888508, 0.14309403135019838, 0.1430434841680591, 0.1423681327633062, 0.14361299638366845, 0.14282893516361733, 0.14288976661817263, 0.14428239777183963, 0.1426949831735536, 0.14369608200770737, 0.14240330063331616, 0.14433469512899852, 0.14510698110135622, 0.1440350965153419, 0.14298300215210513, 0.14233686299677759, 0.14359903606283972, 0.14357301201420264, 0.14434261419778532, 0.1440299032745335, 0.1450649569043168, 0.1437694586374133, 0.14374376478479736, 0.14402711146388614, 0.145465482904555, 0.1443055267483825, 0.14358095396753165, 0.1431767395167342, 0.14362732229015016, 0.14486759244603276, 0.1437376989443649, 0.1440838070073625, 0.14325902540487254, 0.14467625154191427, 0.14342528903469653, 0.14323593011466956, 0.1419545373913421, 0.14290046938902465, 0.14210651122491832, 0.14405957039582942, 0.14363571899849537, 0.14223849951915982, 0.14330281290802688, 0.14345814710675417, 0.14356748280142725, 0.1422000854724445, 0.14488268777415914, 0.14236739551278946, 0.1440289081959226, 0.14396910208359723, 0.14368864446360935, 0.14482047494874115, 0.14273512585679768, 0.14375192873532425, 0.14330682999988734, 0.1445952773571611, 0.1420728383605495, 0.1426184413578108, 0.14271916691515024, 0.14367830129991685, 0.14381394975593784, 0.14236619677644335, 0.14370261396140327, 0.14249200670392131, 0.14386229679573284, 0.14244881179889718, 0.1437234377039926, 0.1442667876544733, 0.1430131331992615, 0.14278246196863068, 0.14509623813426156, 0.1431329247386511, 0.1426541243525998, 0.14300605834505326, 0.14519963094158397, 0.14390380761468824, 0.14369292961722674, 0.14282428660284677, 0.14356879796258962, 0.14332148956517543, 0.14495442050457927, 0.14375969582773615, 0.14615334340983738, 0.14284764721985738, 0.14514506577615213, 0.14266674627270923, 0.14353904588703542, 0.14363609848147463, 0.14365355611635405, 0.14317351628633693, 0.14672594294305333, 0.14429980753703783, 0.1433786441544501, 0.14228518288512312, 0.1433901473116922, 0.14257311818646798, 0.14378047232998864, 0.14355616977852817, 0.14476076963835582, 0.1427688991458338, 0.14298486652892523, 0.14353371725761177, 0.14688814443531686, 0.1424495380005526, 0.14347814082700946, 0.143798457035505, 0.14669897910963586, 0.14341448170197518, 0.14293356806873372, 0.14316558105881305, 0.1421617362342897, 0.14399020826771153, 0.14273038029575005, 0.14253554820687211, 0.14276313005101712, 0.14278628460921292, 0.14488079686638328, 0.14315411354772603, 0.14409588561407405, 0.14284642359296862, 0.14298613920182945, 0.14281751366533957, 0.1440328811340716, 0.1445582137549581, 0.14441265461113567, 0.14699273853086278, 0.14240895455198926, 0.14460767707474279, 0.14396509274419123, 0.14205164863166356, 0.14222157135599692, 0.1439426534762326, 0.1420945918512396, 0.14306479796292584, 0.14433354095034623, 0.14251211124832863, 0.1426952757930964, 0.14337620574376808, 0.14376364428322, 0.14318867102546365, 0.1432083864564202, 0.14310138457439056, 0.1433928858873722, 0.14542581065651763, 0.14191179875042517, 0.14740323534438393, 0.14702318624953514, 0.1438448705390408, 0.1432215325914677, 0.1427814172113212, 0.14294670839723067, 0.14240015432093345, 0.14163735276601094, 0.14201393918245178, 0.14384053473738978, 0.14554926943795019, 0.14253370442814323, 0.1425136126297682, 0.14376273733007305, 0.14305664870433515, 0.14373085254606385, 0.14182570239737613, 0.14382233096271282, 0.14238361116072887, 0.1429118600088067, 0.1416940878724904, 0.14208045722649976, 0.1427422668127551, 0.1433489161141757, 0.14263957018886333, 0.14247989317165682, 0.14230463159369666, 0.14328041790395674, 0.1452803073663139, 0.14169514654827126, 0.14450689810103345, 0.14265186826760493, 0.1446903571172079, 0.14333867543345716, 0.14358358177859973, 0.14304193774258886, 0.14330201068590992, 0.14352562441465377, 0.14427109666808885, 0.14308356907348208, 0.1438965149705968, 0.1426904368075162, 0.14382401585396404, 0.1426487763453787, 0.14136105969477555, 0.14523118095778292, 0.14595992654565335, 0.14642473271698034, 0.1429846837291431, 0.1435766724937148, 0.14311906392879956, 0.1448173483719529, 0.14367679982443735, 0.14283232543292104, 0.14259085679551503, 0.14284030211092472, 0.1428070917579217, 0.14303975568763563, 0.14327649826365388, 0.14430483645775208, 0.14528885063956257, 0.142297236243495, 0.14353716600530644, 0.1432515854335418, 0.14241803007196813, 0.1437561996282538, 0.14198098658019645, 0.14439999183594743, 0.14271237671713596, 0.14235858940340113, 0.14425499879825088, 0.14283779598033838, 0.14401579217202695, 0.14481026123356547, 0.1411216680741327, 0.14312746035892002, 0.14249932500701215, 0.14358815804823336, 0.14245843320696575, 0.14243111046584575, 0.143905982000098, 0.1434317152056729, 0.14201359858026852, 0.14378584443815054, 0.1449314752654359, 0.1437191009296679, 0.14388429118064588, 0.14220263147653273, 0.14241191221908786, 0.14342335528197844, 0.14390446948632973, 0.14252101057525032, 0.14316768470391064, 0.14370694643882495, 0.14282983722112155, 0.14236321115832987, 0.1424903394599096, 0.1429607144342811, 0.14297412929326042, 0.14418940145832995, 0.14259762366382753, 0.14371895297586645, 0.14246106093067126, 0.14275756704728934, 0.14174958484154748, 0.14226925736772786, 0.14318630705826527, 0.1417926426034711, 0.14243723892520999, 0.14382736981660713]
vae_train_loss_history = []
vae_test_loss_history = []


def vae_objective(X):
    print("Executing vae_objective...")
    X_train, X_test = train_test_split(X, test_size=0.2, random_state=42)

    X_train = torch.tensor(X_train, dtype=torch.float32)
    X_test = torch.tensor(X_test, dtype=torch.float32)

    train_dataset = TensorDataset(X_train, X_train)
    train_dataloader = DataLoader(train_dataset, batch_size=64, shuffle=True)
    test_dataset = TensorDataset(X_test, X_test)
    test_dataloader = DataLoader(test_dataset, batch_size=64, shuffle=False)

    torch.manual_seed(42)
    model = VAE()
    optimizer = optim.Adam(model.parameters(), lr=0.0001)

    best_mse = float('inf')
    best_weights = None

    train_loss_ma = None
    test_loss_ma = None
    convergence_threshold = 0.0001
    consecutive_epochs_no_improvement = 0

    # Training
    num_epoch = 3000
    for epoch in range(num_epoch):
        model.train()
        total_loss = 0.0
        for X_train_batch in train_dataloader:
            optimizer.zero_grad()
            # Extract input from tuple
            X_train_batch = X_train_batch[0]
            x_recon, mu, logvar = model(X_train_batch)
            # MSE + KL
            batch_loss = model.vae_loss(x_recon, X_train_batch, mu, logvar)
            batch_loss.backward()
            optimizer.step()
            total_loss += batch_loss.item() * len(X_train_batch)

        total_loss /= len(X_train)
        vae_train_loss_history.append(total_loss)

        # Evaluating on the validation set
        model.eval()
        test_mse = 0.0
        with torch.no_grad():
            for X_test_batch in test_dataloader:
                # Extract input from tuple
                X_test_batch = X_test_batch[0]
                x_recon, mu, logvar = model(X_test_batch)
                # MSE
                batch_mse = F.mse_loss(x_recon, X_test_batch).item()
                test_mse += batch_mse * len(X_test_batch)

        test_mse /= len(X_test)
        vae_test_loss_history.append(test_mse)

        if train_loss_ma is None:
            train_loss_ma = total_loss
        else:
            train_loss_ma = (train_loss_ma * epoch + total_loss) / (epoch + 1)

        if test_loss_ma is None:
            test_loss_ma = test_mse
        else:
            test_loss_ma = (test_loss_ma * epoch + test_mse) / (epoch + 1)

        if epoch > 0:
            if abs(test_loss_ma - vae_test_loss_history[-2]) < convergence_threshold:
                consecutive_epochs_no_improvement += 1
                if consecutive_epochs_no_improvement >= 5:
                    print(f"Model converges at {epoch}th epoch")
                    break
            else:
                consecutive_epochs_no_improvement = 0

        if test_mse < best_mse:
            best_mse = test_mse
            best_weights = copy.deepcopy(model.state_dict())
            torch.save(model.state_dict(), "/home/fanqiany/data/fanqiany/VAE.pth")
            print(f"Epoch {epoch + 1}/{num_epoch}, Test MSE: {test_mse:.6f}")

    return best_mse


best_mse = vae_objective(cleaned_df)
print("Best VAE MSE:", best_mse)

# Explained variance
cov_matrix = np.cov(cleaned_df.T)
explained_var = 1 - 19 * best_mse / np.trace(cov_matrix)
print("Explained Variance of VAE:", explained_var)

print("Train History:", vae_train_loss_history)
print("Test History:", vae_test_loss_history)


# Plot VAE
def plot_vae(data):
    data = torch.tensor(data, dtype=torch.float32)
    model = VAE(input_size=19, latent_size=2)

    model.eval()
    with torch.no_grad():
        x = model.encoder(data)
        x = torch.flatten(x, start_dim=1)
        mu = model.fc_mu(x)
        logvar = model.fc_var(x)
        latent = model.reparameterize(mu, logvar)

    plt.figure(figsize=(10, 8))
    plt.hist2d(latent[:, 0], latent[:, 1], bins=(50, 50), cmap='viridis')
    plt.colorbar(label='Frequency')
    plt.title('VAE of Chemical Abundances')
    plt.xlabel('Latent Component 1')
    plt.ylabel('Latent Component 2')
    plt.grid(True)
    plt.xlim(latent[:, 0].min(), latent[:, 0].max())
    plt.ylim(latent[:, 1].min(), latent[:, 1].max())
    plt.savefig("/home/fanqiany/data/fanqiany/VAE.png", dpi=300, bbox_inches='tight')
    plt.close()


plot_vae(cleaned_df)
